import{b2 as Jt}from"./main-CbjDkmQq.js";class D{constructor(s,t,e){this.alias=s,this.value=t,this.type=e}static fromRawData(s,t){const e=t.find(i=>i.alias===s.alias);if(!e)return console.warn('No definition found for variable alias "'.concat(s.alias,"\", defaulting to 'unknown'")),new D(s.alias,s.value,"unknown");const a=D.parseValue(s.value,e.type);return new D(s.alias,a,e.type)}static parseValue(s,t){switch(t){case"S":case"PR":return String(s);case"A":case"D":case"R":case"T":return Number(s);case"I":return parseInt(s);case"B":return s.toLocaleLowerCase()==="true"||s==="1";default:return console.warn('unhandled type "'.concat(t,'", returning raw value')),s}}static parseVariables(s,t){const e={};for(const a of s){const i=D.fromRawData(a,t);e[i.alias]=i.value}return e}static parseTypedVariables(s){if(!s)return null;const t={},e={};for(const a of s.variables)e[a.alias]=D.parseValue(a.value,a.type);return t[s.name]=e,t}static parseTypedVariablesArray(s){if(!s)return null;const t={};for(const e of s){const a=this.parseTypedVariables(e);a&&a[e.name]&&(t[e.name]=a[e.name])}return t}}const H=class H{constructor(s,t,e,a,i,o,n,r,g,d){this.swoodVersion=s,this.schemaVersion=t,this.name=e,this.projectPath=a,this.reportPath=i,this.createdDate=o,this.createdBy=n,this.documents=r,this.messages=g,this.variables=d}static fromProjectRaw(s,t){const e=D.parseVariables(s.variables,t);return H.reportPath=s.reportPath,new H(s.reportVersion,s.schemaVersion,s.projectName,s.projectPath,s.reportPath,s.createdDate,s.createdBy,B.fromDocumentsRaw(s.documents),s.messages,e)}};H.reportPath="",H.getReportPath=()=>H.reportPath;let K=H;const G=class G{constructor(s,t,e,a,i,o,n,r,g,d){this.name=s,this.type=t,this.docType=e,this.processingStatus=a,this.absoluteURI=i,this.relativeURI=o,this.hidden=n,this.storageType=r,this.exists=g,this.objType=d}};G.fromDocumentRaw=s=>{var i;let t="";const e="file:///"+K.getReportPath().replace(/\\/g,"/")+"/",a=s.absoluteURI;return a.startsWith(e)&&(t=a.slice(e.length)),new G((i=s.documentName)!=null?i:"",s.type,s.docType,s.processingStatus,s.absoluteURI,t,s.hidden,s.storageType,s.exists,s.objType)},G.fromDocumentsRaw=s=>{const t=[];for(const e of s!=null?s:[])t.push(G.fromDocumentRaw(e));return t};let B=G;class kt{constructor(s,t,e,a,i,o,n,r,g,d){this.key=s,this.messages=t,this.variables=e,this.heritedVariables=a,this.typedObjectVariables=i,this.refPrograms=o,this.refParts=n,this.refAssemblies=r,this.documents=g,this.swcps=d,this.programs=[],this.parts=[],this.assemblies=[]}static fromAssemblyRaw(s,t){const e=D.parseVariables(s.variables,t),a=D.parseTypedVariablesArray(s.heritedVariables),i=D.parseTypedVariables(s.typedObjectVariables);return new kt(s.ID,s.messages,e,a,i,s.programs,s.parts,s.assemblies,B.fromDocumentsRaw(s.documents),s.swcps)}}class R{constructor(){this.instances=new Map}addInstance(s,t){this.instances.set(s,t)}get(s){return this.instances.get(s)}getAll(){return Array.from(this.instances.values())}getTotalInstances(){return this.instances.size}}class na extends R{addInstances(s){for(const t of s.assemblies)this.addInstance(t.ID,kt.fromAssemblyRaw(t,s.variableDefinitions.assemblies));return this}}const gs=class gs{constructor(s,t){this.articles=s,this.cost=t}};gs.fromToolRaw=s=>new gs(s.articles,s.cost);let Ks=gs;class ra extends R{addInstances(s){return this.addInstance("0",Ks.fromToolRaw(s.costing)),this}}class It{constructor(s,t,e,a,i,o){this.key=s,this.panel=t,this.refMaterial=e,this.variables=a,this.documents=i,this.messages=o}static fromEdgebandRaw(s,t){const e=D.parseVariables(s.variables,t);return new It(s.ID,s.panel,s.edgebandMaterial,e,B.fromDocumentsRaw(s.documents),s.messages)}}class oa extends R{addInstances(s){for(const t of s.edgebands)this.addInstance(t.ID,It.fromEdgebandRaw(t,s.variableDefinitions.edgebands));return this}}class vt{constructor(s,t){this.key=s,this.variables=t}static fromEdgebandMaterialRaw(s,t){const e=D.parseVariables(s.variables,t);return new vt(s.ID,e)}}class ha extends R{addInstances(s){var t;for(const e of(t=s.edgebandMaterials)!=null?t:[])this.addInstance(e.ID,vt.fromEdgebandMaterialRaw(e,s.variableDefinitions.edgebandMaterials));return this}}const cs=class cs{constructor(s,t,e,a){this.key=s,this.messages=t,this.documents=e,this.variables=a}};cs.fromMaterialRaw=(s,t)=>{const e=D.parseVariables(s.variables,t);return new cs(s.ID,s.messages,B.fromDocumentsRaw(s.documents),e)};let Xs=cs;class ga extends R{addInstances(s){var t;for(const e of(t=s.materials)!=null?t:[])this.addInstance(e.ID,Xs.fromMaterialRaw(e,s.variableDefinitions.materials));return this}}class Ct{constructor(s,t,e,a,i,o,n,r,g){this.key=s,this.name=t,this.refPrograms=e,this.refStocks=a,this.refProcessZones=i,this.refEdgeband=o,this.messages=n,this.documents=r,this.variables=g,this.programs=[],this.stocks=[],this.edgebands=[]}static fromPanelRaw(s,t){const e=D.parseVariables(s.variables,t);return new Ct(s.ID,s.name,s.programs,s.stocks,s.processZones,s.edgebands,s.messages,B.fromDocumentsRaw(s.documents),e)}}class ca extends R{addInstances(s){var t;for(const e of(t=s.panels)!=null?t:[])this.addInstance(e.ID,Ct.fromPanelRaw(e,s.variableDefinitions.panels));return this}}class At{constructor(s,t,e,a){this.key=s,this.messages=t,this.documents=e,this.variables=a}static fromPanelProcessRaw(s,t){const e=D.parseVariables(s.variables,t);return new At(s.ID,s.messages,B.fromDocumentsRaw(s.documents),e)}}class la extends R{addInstances(s){var t;if(!s.panelProcesses)return this;for(const e of s.panelProcesses)this.addInstance(e.ID,At.fromPanelProcessRaw(e,(t=s.variableDefinitions.panelProcesses)!=null?t:[]));return this}}class Bt{constructor(s,t,e,a,i,o){this.key=s,this.refPanel=t,this.refPanelProcess=e,this.messages=a,this.documents=i,this.variables=o}static fromProcessZoneRaw(s,t){const e=D.parseVariables(s.variables,t);return new Bt(s.ID,s.panel,s.panelProcess,s.messages,B.fromDocumentsRaw(s.documents),e)}}class da extends R{addInstances(s){var t;if(!s.processZones)return this;for(const e of s.processZones)this.addInstance(e.ID,Bt.fromProcessZoneRaw(e,(t=s.variableDefinitions.processZones)!=null?t:[]));return this}}class St{constructor(s,t,e,a,i,o,n,r,g,d,h){this.key=s,this.refPrograms=t,this.refStocks=e,this.refPanel=a,this.bodyCount=i,this.messages=o,this.variables=n,this.heritedVariables=r,this.typedObjectVariables=g,this.documents=d,this.swcps=h,this.programs=[],this.stocks=[]}static fromPartRaw(s,t){const e=D.parseVariables(s.variables,t),a=D.parseTypedVariablesArray(s.heritedVariables),i=D.parseTypedVariables(s.typedObjectVariables);return new St(s.ID,s.programs,s.stocks,s.panel,s.bodyCount,s.messages,e,a,i,B.fromDocumentsRaw(s.documents),s.swcps)}}class ma extends R{addInstances(s){for(const t of s.parts)this.addInstance(t.ID,St.fromPartRaw(t,s.variableDefinitions.parts));return this}}class Et{constructor(s,t,e,a,i,o,n){this.key=s,this.refTools=t,this.programParts=e,this.nestingBoard=a,this.messages=i,this.documents=o,this.variables=n,this.tools=[]}static fromProgramRaw(s,t){const e=D.parseVariables(s.variables,t);return new Et(s.ID,s.tools,s.programParts,s.nestingBoard,s.messages,B.fromDocumentsRaw(s.documents),e)}}class fa extends R{addInstances(s){for(const t of s.programs)this.addInstance(t.ID,Et.fromProgramRaw(t,s.variableDefinitions.programs));return this}}class Rt{constructor(s,t,e,a,i,o){this.key=s,this.part=t,this.program=e,this.documents=a,this.messages=i,this.variables=o}static fromProgramPartRaw(s,t){const e=D.parseVariables(s.variables,t);return new Rt(s.ID,s.part,s.program,B.fromDocumentsRaw(s.documents),s.messages,e)}}class ua extends R{addInstances(s){for(const t of s.programParts)this.addInstance(t.ID,Rt.fromProgramPartRaw(t,s.variableDefinitions.programParts));return this}}class Nt{constructor(s,t,e,a){this.key=s,this.messages=t,this.documents=e,this.variables=a}static fromSpindleRaw(s,t){const e=D.parseVariables(s.variables,t);return new Nt(s.ID,s.messages,B.fromDocumentsRaw(s.documents),e)}}class pa extends R{addInstances(s){var t;if(!s.spindles)return this;for(const e of s.spindles)this.addInstance(e.ID,Nt.fromSpindleRaw(e,(t=s.variableDefinitions.spindles)!=null?t:[]));return this}}const ls=class ls{constructor(s,t,e,a,i,o){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=o}};ls.fromStockRaw=(s,t)=>{const e=D.parseVariables(s.variables,t);return new ls(s.ID,s.part,s.material,s.messages,B.fromDocumentsRaw(s.documents),e)};let Js=ls;class ba extends R{addInstances(s){for(const t of s.stocks)this.addInstance(t.ID,Js.fromStockRaw(t,s.variableDefinitions.stocks));return this}}class Lt{constructor(s,t,e,a){this.key=s,this.variables=t,this.messages=e,this.documents=a}static fromToolRaw(s,t){const e=D.parseVariables(s.variables,t);return new Lt(s.ID,e,s.messages,B.fromDocumentsRaw(s.documents))}}class Pa extends R{addInstances(s){var t;for(const e of(t=s.tools)!=null?t:[])this.addInstance(e.ID,Lt.fromToolRaw(e,s.variableDefinitions.tools));return this}}class Ma{constructor(){this.instances=new Map}addInstance(s,t){const e=this.instances.get(s);e?e.push(t):this.instances.set(s,[t])}addInstances(s,t,e){for(const a of s.typedObjects){const i=t.get(a);if(i){const n=i.variables.TOTYPES.split(";");for(const r of n)this.addInstance(r,i)}const o=e.get(a);if(o){const n=o.variables.TOTYPES.split(";");for(const r of n)this.addInstance(r,o)}}return this}getInstancesById(s){return this.instances.get(s)||null}getAll(){return this.instances}}class X{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b,P,w,T,v,I,A,S,E,k,N,L,x,F,U){this.database=s,this.projectData=t,this.panelsData=e,this.stocksData=a,this.partsData=i,this.assembliesData=o,this.edgebandsData=n,this.edgebandMaterialsData=r,this.materialsData=g,this.programsData=d,this.programPartsData=h,this.toolsData=c,this.spindlesData=m,this.costsData=f,this.typedObjectsData=u,this.panelProcessesData=p,this.processZonesData=b,this.panelDataManager=P,this.stockDataManager=w,this.partDataManager=T,this.assemblyDataManager=v,this.edgebandDataManager=I,this.edgebandMaterialDataManager=A,this.materialDataManager=S,this.programDataManager=E,this.programPartDataManager=k,this.toolDataManager=N,this.spindleDataManager=L,this.costDataManager=x,this.panelProcessDataManager=F,this.processZoneDataManager=U}static createFromRawData(s){const t=K.fromProjectRaw(s,s.variableDefinitions.report),e=new ca().addInstances(s),a=new ba().addInstances(s),i=new ma().addInstances(s),o=new na().addInstances(s),n=new oa().addInstances(s),r=new ha().addInstances(s),g=new ga().addInstances(s),d=new fa().addInstances(s),h=new ua().addInstances(s),c=new Pa().addInstances(s),m=new pa().addInstances(s),f=new ra().addInstances(s),u=new Ma().addInstances(s,i,o),p=new la().addInstances(s),b=new da().addInstances(s);return new X(s,t,e.getAll(),a.getAll(),i.getAll(),o.getAll(),n.getAll(),r.getAll(),g.getAll(),d.getAll(),h.getAll(),c.getAll(),m.getAll(),f.getAll(),u.getAll(),p.getAll(),b.getAll(),e,a,i,o,n,r,g,d,h,c,m,f,p,b).relateData()}relateData(){return this.assignDataToEdgebands(),this.assignDataToStocks(),this.assignDataToPanels(),this.assignDataToAssemblies(),this.assignSubAssemblies(),this.assignDataToParts(),this}assignDataToEdgebands(){for(const s of this.edgebandDataManager.getAll())s.material=this.edgebandMaterialDataManager.get(s.refMaterial)}assignDataToStocks(){for(const s of this.stockDataManager.getAll()){const t=this.materialDataManager.get(s.refMaterial);s.material=t}}assignDataToPanels(){for(const s of this.panelDataManager.getAll()){for(const e of s.refStocks){const a=this.stockDataManager.get(e);a&&(s.stocks.push(a),a.variables.ST_N==="CORE"&&(s.material=a.material))}for(const e of s.refEdgeband){const a=this.edgebandDataManager.get(e);a&&s.edgebands.push(a)}for(const e of s.refPrograms){const a=this.programDataManager.get(e);a&&s.programs.push(a)}const t=this.partDataManager.get(s.key);t&&(s.part=t)}}assignDataToAssemblies(){var s,t;for(const e of this.assemblyDataManager.getAll()){for(const a of e.refParts){const i=this.partDataManager.get(a);i&&((s=e.parts)==null||s.push(i))}for(const a of e.refPrograms){const i=this.programDataManager.get(a);i&&((t=e.programs)==null||t.push(i))}}}assignSubAssemblies(){var s;for(const t of this.assemblyDataManager.getAll())for(const e of t.refAssemblies){const a=this.assemblyDataManager.get(e);a&&((s=t.assemblies)==null||s.push(a))}}assignDataToParts(){var s;for(const t of this.partDataManager.getAll()){t.panel=t.refPanel?this.panelDataManager.get(t.refPanel):void 0;for(const e of(s=t.refStocks)!=null?s:[]){const a=this.stockDataManager.get(e);a&&t.stocks.push(a)}for(const e of t.refPrograms){const a=this.programDataManager.get(e);a&&(t.programs.push(a),a.part=t)}}}}class C{constructor(){this.instances=new Map}add(s,t){this.instances.set(s,t)}get(s){const t=this.instances.get(s);return t||console.error("".concat(this.constructor.name," - unable to find instance: ").concat(s)),t}getAll(){return Array.from(this.instances.values())}getTotalInstances(){return this.instances.size}}class Qe{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b,P){this.key=s,this.messages=t,this.variables=e,this.heritedVariables=a,this.typedObjectVariables=i,this.refPrograms=o,this.refParts=n,this.refAssemblies=r,this.documents=g,this.swcps=d,this.name=h,this.description=c,this.configuration=m,this.quantity=f,this.height=u,this.width=p,this.depth=b,this.images=P,this.programs=[],this.parts=[],this.assemblies=[]}static fromAssemblyBusiness(s){return s.createViewModel()}}const $=class ${constructor(s,t,e,a,i,o,n,r){this.type=s,this.typeDescription=t,this.description=e,this.message=a,this.messageType=i,this.item=o,this.category=n,this.url=r}};$.fromMessageRaw=(s,t="",e="",a="")=>new $(s.type,s.typeDesc,s.desc,s.message,s.messageType,t,e,a),$.fromMessagesRaw=(s,t="",e="",a="")=>{const i=[];for(const o of s!=null?s:[])i.push($.fromMessageRaw(o,t,e,a));return i};let M=$;class V{constructor(s){this.documents=s}getImages(){var t;const s={};for(const e of(t=this.documents)!=null?t:[])if(e.docType==="IMAGE"){const a=e.absoluteURI,i=a.substring(a.indexOf("images"));e.name!==null&&(s[e.name]=i)}return s}}const ds=class ds{constructor(s,t,e,a,i,o,n,r,g,d){this.key=s,this.messages=t,this.variables=e,this.heritedVariables=a,this.typedObjectVariables=i,this.refPrograms=o,this.refParts=n,this.refAssemblies=r,this.documents=g,this.swcps=d,this.programs=[],this.parts=[],this.assemblies=[],this.getName=()=>this.variables.NAME,this.getDescription=()=>this.variables.Description,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>this.variables.NB,this.getHeight=()=>this.variables.Height,this.getWidth=()=>this.variables.Width,this.getDepth=()=>this.variables.Depth,this.getImages=()=>new V(this.documents).getImages()}createViewModel(){return new Qe(this.key,M.fromMessagesRaw(this.messages,this.getName(),"Assembly"),this.variables,this.heritedVariables,this.typedObjectVariables,this.refPrograms,this.refParts,this.refAssemblies,this.documents,this.swcps,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getHeight(),this.getWidth(),this.getDepth(),this.getImages())}};ds.fromAssemblyData=s=>new ds(s.key,s.messages,s.variables,s.heritedVariables,s.typedObjectVariables,s.refPrograms,s.refParts,s.refAssemblies,s.documents,s.swcps);let _s=ds;class _t extends C{constructor(){super(...arguments),this.addPrograms=s=>{const t=this.getAll();for(const e of t)for(const a of e.refPrograms){const i=s.get(a);i&&e.programs.push(i)}},this.addParts=s=>{const t=this.getAll();for(const e of t)for(const a of e.refParts){const i=s.get(a);i&&e.parts.push(i)}},this.addAssemblies=s=>{const t=this.getAll();for(const e of t)for(const a of e.refAssemblies){const i=s.get(a);i&&e.assemblies.push(i)}}}addInstances(s){for(const t of s)this.add(t.key,_s.fromAssemblyData(t));return this}}class qe{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b,P){this.swoodVersion=s,this.schemaVersion=t,this.name=e,this.projectPath=a,this.reportPath=i,this.createdDate=o,this.createdBy=n,this.documents=r,this.messages=g,this.variables=d,this.isDesign=h,this.isCam=c,this.isNesting=m,this.images=f,this.pdfs=u,this.configuration=p,this.description=b,this.reportVersion=P}static fromProjectBusiness(s){return s.createViewModel()}}class Ot{constructor(s){this.documents=s}getDocuments(){var t;const s={};for(const e of(t=this.documents)!=null?t:[])e.name!==null&&(s[e.name]=e);return s}}class Wt{constructor(s){this.documents=s}getPDFs(){var t;const s={};for(const e of(t=this.documents)!=null?t:[])e.docType==="DRAWING2PDF"&&e.exists&&e.name!==null&&(s[e.name]=e.relativeURI);return s}}const ms=class ms{constructor(s,t,e,a,i,o,n,r,g,d){this.swoodVersion=s,this.schemaVersion=t,this.name=e,this.projectPath=a,this.reportPath=i,this.createdDate=o,this.createdBy=n,this.documents=r,this.messages=g,this.variables=d,this.getIsDesign=()=>{var h;return(h=this.variables.REPORT_ISUSINGDESIGN)!=null?h:!1},this.getIsCam=()=>{var h;return(h=this.variables.REPORT_ISUSINGCAM)!=null?h:!1},this.getIsNesting=()=>{var h;return(h=this.variables.REPORT_ISNESTINGPROJECT)!=null?h:!1},this.getImages=()=>new V(this.documents).getImages(),this.getPDFs=()=>new Wt(this.documents).getPDFs(),this.getDocuments=()=>new Ot(this.documents).getDocuments(),this.getConfiguration=()=>{var h,c;return(c=(h=this.component)==null?void 0:h.getConfiguration())!=null?c:""},this.getDescription=()=>{var h,c;return(c=(h=this.component)==null?void 0:h.getDescription())!=null?c:""},this.getReportVersion=()=>{var h;return(h=this.variables.ReportVersion)!=null?h:"0.0.0"}}createViewModel(){return new qe(this.swoodVersion,this.schemaVersion,this.name,this.projectPath,this.reportPath,this.createdDate,this.createdBy,this.getDocuments(),M.fromMessagesRaw(this.messages,this.name,"Project"),this.variables,this.getIsDesign(),this.getIsCam(),this.getIsNesting(),this.getImages(),this.getPDFs(),this.getConfiguration(),this.getDescription(),this.getReportVersion())}};ms.fromProjectData=s=>new ms(s.swoodVersion,s.schemaVersion,s.name,s.projectPath,s.reportPath,s.createdDate,s.createdBy,s.documents,s.messages,s.variables);let J=ms;const fs=class fs{constructor(s,t){this.articles=s,this.cost=t}};fs.fromCostData=s=>new fs(s.articles,s.cost);let st=fs;class se extends C{addInstances(s){return this.add("0",st.fromCostData(s[0])),this}}const us=class us{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b){this.key=s,this.refPanel=t,this.refMaterial=e,this.variables=a,this.documents=i,this.messages=o,this.name=n,this.quantity=r,this.length=g,this.lengthStock=d,this.width=h,this.thickness=c,this.extension=m,this.position=f,this.isCurved=u,this.isPaint=p,this.cost=b}static fromEdgebandBusiness(s){return s.createViewModel()}};us.createCombinedEdgeband=(s,t,e)=>new us(s.key,s.refPanel,s.refMaterial,s.variables,s.documents,s.messages,t,e,s.length,s.lengthStock,s.width,s.thickness,s.extension,s.position,s.isCurved,s.isPaint,s.cost);let z=us;const ps=class ps{constructor(s,t,e,a,i,o){this.key=s,this.refPanel=t,this.refMaterial=e,this.variables=a,this.documents=i,this.messages=o,this.getName=()=>{var n;return(n=this.variables.EB_N)!=null?n:""},this.getQuantity=()=>{var n,r;return(r=(n=this.panel)==null?void 0:n.getThickness())!=null?r:0},this.getLength=()=>this.variables.EB_L,this.getLengthStock=()=>this.variables.EB_LSTOCK,this.getWidth=()=>{var n,r;return(r=(n=this.panel)==null?void 0:n.getThickness())!=null?r:0},this.getThickness=()=>{var n,r;return(r=(n=this.material)==null?void 0:n.getThickness())!=null?r:0},this.getExtension=()=>{var n,r;return(r=(n=this.material)==null?void 0:n.getExtension())!=null?r:0},this.getPosition=()=>this.variables.EB_STOCKPOSITION,this.getIsCurved=()=>{var n;return(n=this.variables.EB_ISCURVED)!=null?n:!1},this.getIsPaint=()=>{var n,r;return(r=(n=this.material)==null?void 0:n.getIsPaint())!=null?r:!1},this.getCost=()=>{var g,d;const n=(this.getLength()+this.getExtension())/1e3,r=n*((d=(g=this.material)==null?void 0:g.getCostUnit())!=null?d:0);return this.material?this.material.quantity+=n:console.warn("edgeband material not defined for ".concat(this.getName())),r}}createViewModel(){return new z(this.key,this.refPanel,this.refMaterial,this.variables,this.documents,M.fromMessagesRaw(this.messages,this.getName(),"Edgeband"),this.getName(),this.getQuantity(),this.getLength(),this.getLengthStock(),this.getWidth(),this.getThickness(),this.getExtension(),this.getPosition(),this.getIsCurved(),this.getIsPaint(),this.getCost())}};ps.fromEdgebandData=s=>new ps(s.key,s.panel,s.refMaterial,s.variables,s.documents,s.messages);let tt=ps;class te extends C{constructor(){super(...arguments),this.addMaterials=s=>{const t=this.getAll();for(const e of t){const a=s.get(e.refMaterial);a&&(e.material=a)}}}addInstances(s){for(const t of s)this.add(t.key,tt.fromEdgebandData(t));return this}}class ze{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m){this.key=s,this.variables=t,this.name=e,this.description=a,this.reference=i,this.thickness=o,this.extension=n,this.isPaint=r,this.cost=g,this.costUnit=d,this.costType=h,this.quantity=c,this.unitOfMeasure=m}static fromEdgebandMaterialBusiness(s){return s.createViewModel()}}const bs=class bs{constructor(s,t,e){this.key=s,this.variables=t,this.quantity=e,this.createViewModel=()=>new ze(this.key,this.variables,this.getName(),this.getDescription(),this.getReference(),this.getThickness(),this.getExtension(),this.getIsPaint(),this.getCost(),this.getCostUnit(),2,this.quantity,"m"),this.getName=()=>{var a;return(a=this.variables.EBMAT_C)!=null?a:""},this.getDescription=()=>{var a;return(a=this.variables.EBMAT_D)!=null?a:""},this.getReference=()=>{var a;return(a=this.variables.EBMAT_REF)!=null?a:""},this.getCostUnit=()=>this.variables.EBMAT_UCOST,this.getThickness=()=>{var a;return(a=this.variables.EBMAT_T)!=null?a:0},this.getIsPaint=()=>{var a;return(a=this.variables.PAINT)!=null?a:!1},this.getExtension=()=>{var a;return(a=this.variables.EXTENSION)!=null?a:0},this.getCost=()=>this.quantity*this.getCostUnit()}};bs.fromEdgebandMaterialData=s=>new bs(s.key,s.variables,0);let et=bs;class ee extends C{addInstances(s){for(const t of s)this.add(t.key,et.fromEdgebandMaterialData(t));return this}}class y{constructor(){this.instances=new Map}addInstance(s,t){this.instances.set(s,t)}get(s){return this.instances.get(s)}getAll(){return Array.from(this.instances.values())}getTotalInstances(){return this.instances.size}groupBy(s){const t=new Map;for(const e of this.getAll()){const a=this.getNestedValue(e,s.toString());t.has(a)||t.set(a,[]),t.get(a).push(e)}return t}getNestedValue(s,t){return t.split(".").reduce((e,a)=>e==null?void 0:e[a],s)}}const Gt=class Gt{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b,P,w,T,v,I,A){this.key=s,this.messages=t,this.heritedVariables=e,this.typedObjectVariables=a,this.refParts=i,this.refAssemblies=o,this.documents=n,this.swcps=r,this.variables=g,this.id=d,this.name=h,this.description=c,this.configuration=m,this.quantity=f,this.height=u,this.width=p,this.depth=b,this.url=P,this.images=w,this.pdfs=T,this.cost=v,this.costPanels=I,this.costHardware=A,this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.hardware=[],this.weldments=[]}};Gt.fromFrameBusiness=s=>s.createViewModel();let _=Gt;const Ps=class Ps{constructor(s,t,e,a,i,o,n,r,g){this.key=s,this.messages=t,this.heritedVariables=e,this.typedObjectVariables=a,this.refParts=i,this.refAssemblies=o,this.documents=n,this.swcps=r,this.variables=g,this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.hardware=[],this.weldments=[],this.getID=()=>this.variables.ID,this.getName=()=>this.variables.NAME,this.getDescription=()=>this.variables.Description,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>this.variables.NB,this.getHeight=()=>this.variables.Height,this.getWidth=()=>this.variables.Width,this.getDepth=()=>this.variables.Depth,this.getImages=()=>new V(this.documents).getImages(),this.getPDFs=()=>new Wt(this.documents).getPDFs(),this.getDocuments=()=>new Ot(this.documents).getDocuments(),this.getUrl=()=>"frames/".concat(this.key),this.getCostPanels=()=>{let d=0;for(const h of this.panels)d+=h.getCost();return d},this.getCostHardware=()=>{let d=0;for(const h of this.hardware)d+=h.getCost();return d},this.getCost=()=>this.getCostPanels()+this.getCostHardware()}createViewModel(){return new _(this.key,M.fromMessagesRaw(this.messages,this.getName(),"Frame",this.getUrl()),this.heritedVariables,this.typedObjectVariables,this.refParts,this.refAssemblies,this.getDocuments(),this.swcps,this.variables,this.getID(),this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getHeight(),this.getWidth(),this.getDepth(),this.getUrl(),this.getImages(),this.getPDFs(),this.getCost(),this.getCostPanels(),this.getCostHardware())}};Ps.fromAssemblyPartBusiness=s=>new Ps(s.key,s.messages,s.heritedVariables,s.typedObjectVariables,"refParts"in s?s.refParts:[],"refAssemblies"in s?s.refAssemblies:[],s.documents,s.swcps,s.variables);let at=Ps;class ae extends y{constructor(){super(...arguments),this.FrameTypedObjectName="FRAME"}addInstances(s){var e;const t=(e=s.getInstancesByName(this.FrameTypedObjectName))!=null?e:[];for(const a of t)this.addInstance(a.key,at.fromAssemblyPartBusiness(a));return this}}const $t=class $t{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b,P,w){this.key=s,this.messages=t,this.heritedVariables=e,this.typedObjectVariables=a,this.refPrograms=i,this.refParts=o,this.refAssemblies=n,this.documents=r,this.swcps=g,this.variables=d,this.name=h,this.description=c,this.configuration=m,this.quantity=f,this.length=u,this.url=p,this.images=b,this.cost=P,this.costUnit=w,this.parts=[],this.assemblies=[],this.panels=[],this.programs=[]}};$t.fromHardwareBusiness=s=>s.createViewModel();let ss=$t;const Ms=class Ms{constructor(s,t,e,a,i,o,n,r,g,d){this.key=s,this.messages=t,this.heritedVariables=e,this.typedObjectVariables=a,this.refPrograms=i,this.refParts=o,this.refAssemblies=n,this.documents=r,this.swcps=g,this.variables=d,this.parts=[],this.assemblies=[],this.panels=[],this.programs=[],this.createViewModel=()=>new ss(this.key,M.fromMessagesRaw(this.messages,this.getName(),"Hardware"),this.heritedVariables,this.typedObjectVariables,this.refPrograms,this.refParts,this.refAssemblies,this.documents,this.swcps,this.variables,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),"",this.getImages(),this.getCost(),this.getCostUnit()),this.getName=()=>this.variables.NAME,this.getDescription=()=>this.variables.Description,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>this.variables.NB,this.getLength=()=>this.variables.Length,this.getImages=()=>new V(this.documents).getImages(),this.getCost=()=>this.getCostUnit()*this.getQuantity(),this.getCostUnit=()=>{var h,c,m;return(m=(c=(h=this.typedObjectVariables)==null?void 0:h.HARDWARE)==null?void 0:c.Cost)!=null?m:0}}};Ms.fromAssemblyPartBusiness=s=>new Ms(s.key,s.messages,s.heritedVariables,s.typedObjectVariables,s.refPrograms,"refParts"in s?s.refParts:[],"refAssemblies"in s?s.refAssemblies:[],s.documents,s.swcps,s.variables);let it=Ms;class ie extends y{constructor(){super(...arguments),this.HardwareTypedObjectName="HARDWARE"}addInstances(s){var e;const t=(e=s.getInstancesByName(this.HardwareTypedObjectName))!=null?e:[];for(const a of t)this.addInstance(a.key,it.fromAssemblyPartBusiness(a));return this}}const Q=class Q{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=o,this.name=n,this.description=r,this.quantity=g,this.length=d,this.width=h,this.thickness=c,this.cost=m}};Q.fromLaminateBusiness=s=>s.createViewModel(),Q.createCombinedLaminate=(s,t,e)=>new Q(s.key,s.refPart,s.refMaterial,s.messages,s.documents,s.variables,t,s.description,e,s.length,s.width,s.thickness,s.cost);let Y=Q;const ws=class ws{constructor(s,t,e,a,i,o,n){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=o,this.settings=n,this.createViewModel=()=>new Y(this.key,this.refPart,this.refMaterial,M.fromMessagesRaw(this.messages,this.getName(),"Laminate"),this.documents,this.variables,this.getName(),this.getDescription(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getCost()),this.getName=()=>this.variables.ST_N,this.getDescription=()=>this.variables.ST_DESC,this.getQuantity=()=>{var r;return(r=this.part)==null?void 0:r.variables.NB},this.getSwoodLength=()=>this.variables.ST_L,this.getSwoodWidth=()=>this.variables.ST_W,this.getThickness=()=>this.variables.ST_T,this.getHasGrain=()=>{var r,g;return(g=(r=this.material)==null?void 0:r.getHasGrain())!=null?g:!1},this.getLength=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).length,this.getWidth=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).width,this.getVolume=()=>this.getLength()*this.getWidth()*this.getThickness()/1e9,this.getSurface=()=>this.getLength()*this.getWidth()/1e6,this.getCost=()=>{if(!this.material)return console.warn("material not defined for ".concat(this.getName())),0;let r=0,g=0;switch(this.material.getCostType()){case 0:g=this.getVolume(),r=this.material.getCostUnit()*g;break;case 1:g=this.getSurface(),r=this.material.getCostUnit()*g;break;case 2:r=this.material.getCostUnit()*this.getLength()/1e3;break;case 3:g=this.material.getCostUnit(),r=g;break;default:return 0}return this.material.quantity+=g*this.getQuantity(),r}}getLongest(s,t,e){return this.settings.LengthLongestEdge?e?{length:s,width:t}:t>s?{width:t,length:s}:{length:s,width:t}:{length:s,width:t}}};ws.fromStockData=(s,t)=>new ws(s.key,s.refPart,s.refMaterial,s.messages,s.documents,s.variables,t);let nt=ws;class ne extends C{addInstances(s,t){var e;for(const a of s)((e=a.material)==null?void 0:e.variables.MAT_TYPE)===1&&this.add(a.key,nt.fromStockData(a,t));return this}}class Ye{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.name=i,this.description=o,this.thickness=n,this.hasGrain=r,this.cost=g,this.costUnit=d,this.costType=h,this.quantity=c,this.type=m,this.unitOfMeasure=f}static fromMaterialBusiness(s){return s.createViewModel()}}const ys=class ys{constructor(s,t,e,a,i){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.quantity=i,this.createViewModel=()=>new Ye(this.key,M.fromMessagesRaw(this.messages,this.getName(),"Material"),this.documents,this.variables,this.getName(),this.getDescription(),this.getThickness(),this.getHasGrain(),this.getCost(),this.getCostUnit(),this.getCostType(),this.quantity,this.getType(),this.getUnitOfMeasure()),this.getName=()=>{var o;return(o=this.variables.MAT_NAME)!=null?o:""},this.getDescription=()=>{var o;return(o=this.variables.MAT_DESC)!=null?o:""},this.getCostUnit=()=>{var o;return(o=this.variables.MAT_UCOST)!=null?o:0},this.getCostType=()=>{var o;return(o=this.variables.MAT_COSTTYPE)!=null?o:0},this.getHasGrain=()=>{var o;return(o=this.variables.MAT_WITHGRAIN)!=null?o:!1},this.getThickness=()=>{var o;return(o=this.variables.MAT_T)!=null?o:0},this.getBoardLength=()=>{var o;return(o=this.variables.BOARD_LENGTH)!=null?o:0},this.getBoardWidth=()=>{var o;return(o=this.variables.BOARD_WIDTH)!=null?o:0},this.getUnitOfMeasure=()=>{switch(this.getCostType()){case 0:return"m³";case 1:return"m²";case 2:return"m";case 3:return"unit";default:return"unknown"}},this.getCost=()=>this.quantity*this.getCostUnit(),this.getType=()=>{var o;return(o=this.variables.MAT_TYPE)!=null?o:0},this.getIsWeldment=()=>{var o;return(o=this.variables.WELDMENT)!=null?o:!1}}};ys.fromMaterialData=s=>new ys(s.key,s.messages,s.documents,s.variables,0);let rt=ys;class re extends C{addInstances(s){for(const t of s)this.add(t.key,rt.fromMaterialData(t));return this}}const ot=(l,s)=>function(t,e){for(const a in l){let i=t[l[a].Property],o=e[l[a].Property];if(oe(i)&&(i=new Date(i)),oe(o)&&(o=new Date(o)),t.combineId!=0&&l[a].Property=="Name"&&(i=s.CombinedPanelName+" "+t.combineId+" - "+t.Name),e.combineId!=0&&l[a].Property=="Name"&&(o=s.CombinedPanelName+" "+e.combineId+" - "+e.Name),t.Multibody&&l[a].Property=="Name"&&(t.Quantity==0?i=t.ParentFrame+" - "+t.Name:t.Quantity!=0&&(t.Quantity>1?i=t.ParentFrame+" - "+t.WeldmentFolder+" - "+t.Name:i=t.ParentFrame+" - "+t.WeldmentFolder)),e.Multibody&&l[a].Property=="Name"&&(e.Quantity==0?o=e.ParentFrame+" - "+e.Name:e.Quantity!=0&&(e.Quantity>1?o=e.ParentFrame+" - "+e.WeldmentFolder+" - "+e.Name:o=e.ParentFrame+" - "+e.WeldmentFolder)),t.hasOwnProperty("CombinedList")&&t.CombinedList.sort(ot(l,s)),e.hasOwnProperty("CombinedList")&&e.CombinedList.sort(ot(l,s)),typeof i=="string"){const n=i.localeCompare(o,"en",{numeric:!0});if(n!=0)return n*l[a].Type}else{if(i>o)return 1*l[a].Type;if(i<o)return-1*l[a].Type}}return 1};function oe(l){if(typeof l!="string")return!1;const s=/^(\d{2})\/(\d{2})\/(\d{4})$/,t=l.match(s);if(t){const a=parseInt(t[1],10),i=parseInt(t[2],10)-1,o=parseInt(t[3],10),n=new Date(o,i,a);return n.getFullYear()===o&&n.getMonth()===i&&n.getDate()===a}const e=new Date(l);return!isNaN(e.getTime())&&l===e.toISOString().split("T")[0]}const wa=l=>l.filter((s,t)=>l.indexOf(s)===t),Ys=(l,s)=>{var n;let t=[],e="";for(const r of l.edgebands)t.push((n=r.material)==null?void 0:n.getName());t=wa(t);for(const r of t)e+=r+", ";e=e.slice(0,-2),l.edgebands!=null&&l.edgebands.sort(ot([{Property:"Order",Type:1}],s));const a=[];for(const r of l.edgebands)!r.getIsPaint()&&!r.getIsCurved()?r.getLengthStock()===l.getLengthStock()?l.getLengthStock()>l.getWidthStock()?a.push("L"):a.push("S"):r.getLengthStock()==l.getWidthStock()?l.getLengthStock()>l.getWidthStock()?a.push("S"):a.push("L"):(console.warn("Unable to categorise EB in: "+l.name),a.push("U")):!r.getIsPaint()&&r.getIsCurved()&&a.push("C");let i="";for(let r=0;r<a.length;r++){let g=1;for(;a[r]==a[r+1];)g++,r++;i+=g+a[r],r!=a.length-1&&(i+=s.EBStringSeparator)}a.sort(),s.EBStringReverse&&a.reverse();let o="";for(let r=0;r<a.length;r++){let g=1;for(;a[r]===a[r+1];)g++,r++;o+=g+a[r],r!=a.length-1&&(o+=s.EBStringSeparator)}return{EBString:o,EBStringOrder:i,EdgingListString:e}},Ds=class Ds{constructor(s,t,e,a,i,o,n,r,g,d){this.key=s,this.name=t,this.refPrograms=e,this.refStocks=a,this.refProcessZones=i,this.refEdgebands=o,this.messages=n,this.documents=r,this.variables=g,this.settings=d,this.programs=[],this.stocks=[],this.edgebands=[],this.laminates=[],this.processZones=[],this.getID=()=>{var h,c;return(c=(h=this.part)==null?void 0:h.variables.ID)!=null?c:""},this.getDescription=()=>{var h,c;return(c=(h=this.part)==null?void 0:h.getDescription())!=null?c:""},this.getConfiguration=()=>{var h,c;return(c=(h=this.part)==null?void 0:h.getConfiguration())!=null?c:""},this.getQuantity=()=>{var h,c;return(c=(h=this.part)==null?void 0:h.getQuantity())!=null?c:0},this.getCombineId=()=>{var h,c;return(c=(h=this.part)==null?void 0:h.getCombinedId())!=null?c:0},this.getSwoodLength=()=>this.variables.PAN_L,this.getSwoodWidth=()=>this.variables.PAN_W,this.getSwoodThickness=()=>this.variables.PAN_T,this.getSwoodLengthWithEdgeband=()=>this.variables.PAN_LWEB,this.getSwoodWidthWithEdgeband=()=>this.variables.PAN_WWEB,this.getSwoodThicknessWithLaminate=()=>this.variables.PAN_TWL,this.getSwoodLengthWithoutEdgeband=()=>this.variables.PAN_LWOEB,this.getSwoodWidthWithoutEdgeband=()=>this.variables.PAN_WWOEB,this.getSwoodThicknessWithoutLaminate=()=>this.variables.PAN_TWOL,this.getSwoodLengthStock=()=>this.variables.PAN_STL,this.getSwoodWidthStock=()=>this.variables.PAN_STW,this.getSwoodThicknessStock=()=>this.variables.PAN_STT,this.getLength=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).length,this.getWidth=()=>this.getLongest(this.getSwoodLength(),this.getSwoodWidth(),this.getHasGrain()).width,this.getThickness=()=>this.getSwoodThickness(),this.getHasEdgebands=()=>this.edgebands.length>0,this.getHasLaminates=()=>this.laminates.length>0,this.getHasPrograms=()=>this.programs.length>0,this.getHasProcessZones=()=>this.processZones.length>0,this.getListEdgebandMaterials=()=>Ys(this,this.settings).EdgingListString,this.getEdgingCode=()=>Ys(this,this.settings).EBString,this.getEdgingCodeOrder=()=>Ys(this,this.settings).EBStringOrder,this.getLengthWithEdgeband=()=>this.getLongest(this.getSwoodLengthWithEdgeband(),this.getSwoodWidthWithEdgeband(),this.getHasGrain()).length,this.getWidthWithEdgeband=()=>this.getLongest(this.getSwoodLengthWithEdgeband(),this.getSwoodLengthWithEdgeband(),this.getHasGrain()).width,this.getThicknessWithLaminate=()=>this.getSwoodThicknessWithLaminate(),this.getLengthWithoutEdgeband=()=>this.getLongest(this.getSwoodLengthWithoutEdgeband(),this.getSwoodWidthWithoutEdgeband(),this.getHasGrain()).length,this.getWidthWithoutEdgeband=()=>this.getLongest(this.getSwoodLengthWithoutEdgeband(),this.getSwoodWidthWithoutEdgeband(),this.getHasGrain()).width,this.getThicknessWithoutLaminate=()=>this.getSwoodThicknessWithoutLaminate(),this.getLengthStock=()=>this.getLongest(this.getSwoodLengthStock(),this.getSwoodWidthStock(),this.getHasGrain()).length,this.getWidthStock=()=>this.getLongest(this.getSwoodLengthStock(),this.getSwoodWidthStock(),this.getHasGrain()).width,this.getThicknessStock=()=>this.getSwoodThicknessStock(),this.getVolume=()=>this.getLength()*this.getWidth()*this.getThickness()/1e9,this.getSurface=()=>this.getLength()*this.getWidth()/1e6,this.getUrl=()=>"panels/".concat(this.key),this.getImages=()=>new V(this.documents).getImages(),this.getPDFs=()=>new Wt(this.documents).getPDFs(),this.getDocuments=()=>new Ot(this.documents).getDocuments(),this.getCost=()=>this.getCostCore()+this.getCostEdgebands()+this.getCostLaminates()+this.getCostProcessZones(),this.getCostCore=()=>{if(!this.material)return console.warn("material not defined for ".concat(this.name)),0;let h=0,c=0;switch(this.material.getCostType()){case 0:c=this.getVolume(),h=this.material.getCostUnit()*c;break;case 1:c=this.getSurface(),h=this.material.getCostUnit()*c;break;case 2:c=this.getLength()/1e3,h=this.material.getCostUnit()*c;break;case 3:c=this.getQuantity(),h=this.material.getCostUnit()*c;break;default:return 0}return this.material.quantity+=c*this.getQuantity(),h},this.getCostEdgebands=()=>{let h=0;for(const c of this.edgebands)h+=c.getCost();return h},this.getCostLaminates=()=>{let h=0;for(const c of this.laminates)h+=c.getCost();return h},this.getCostPrograms=()=>{let h=0;for(const c of this.programs)h+=c.getCost();return h},this.getCostProcessZone=h=>{if(!h.panelProcess)return console.warn("panelProcess not defined for ".concat(this.name)),0;const c=h.panelProcess.getCostUnit(),m=h.getCostType();let f=0,u=0;switch(m){case 0:f=this.getVolume(),u=c*f;break;case 1:f=this.getSurface(),u=c*f;break;case 2:f=this.getLength()/1e3,u=c*f;break;case 3:f=this.getQuantity(),u=c*f;break;default:return 0}return h.panelProcess.quantity+=f,u},this.getCostProcessZones=()=>{let h=0;for(const c of this.processZones)h+=this.getCostProcessZone(c);return h},this.getBoard=()=>{var m,f,u,p;const h=(f=(m=this.material)==null?void 0:m.getBoardLength())!=null?f:0,c=(p=(u=this.material)==null?void 0:u.getBoardWidth())!=null?p:0;return{length:h,width:c}}}createViewModel(){return new Jt(this.key,this.name,this.refPrograms,this.refStocks,this.refProcessZones,this.refEdgebands,M.fromMessagesRaw(this.messages,this.name,"Panel",this.getUrl()),this.variables,this.getDocuments(),this.getID(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getLengthWithEdgeband(),this.getWidthWithEdgeband(),this.getThicknessWithLaminate(),this.getLengthWithoutEdgeband(),this.getWidthWithoutEdgeband(),this.getThicknessWithoutLaminate(),this.getLengthStock(),this.getWidthStock(),this.getThicknessStock(),this.getHasGrain(),this.getHasEdgebands(),this.getHasLaminates(),this.getHasPrograms(),this.getHasProcessZones(),this.getListEdgebandMaterials(),this.getEdgingCode(),this.getEdgingCodeOrder(),this.getVolume(),this.getNameHead(),this.getNameTail(),this.getBoard(),this.getUrl(),this.getImages(),this.getPDFs(),this.getCost(),this.getCostCore(),this.getCostEdgebands(),this.getCostLaminates(),this.getCostPrograms(),this.getCostProcessZones(),this.getCombineId(),this.settings)}createCombinedViewModel(){return new Jt("Combined Panel ".concat(this.getCombineId()),"Combined Panel ".concat(this.getCombineId()),this.refPrograms,this.refStocks,this.refProcessZones,this.refEdgebands,M.fromMessagesRaw(this.messages,"Panel"),this.variables,this.getDocuments(),this.getID(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getLengthWithEdgeband(),this.getWidthWithEdgeband(),this.getThicknessWithLaminate(),this.getLengthWithoutEdgeband(),this.getWidthWithoutEdgeband(),this.getThicknessWithoutLaminate(),this.getLengthStock(),this.getWidthStock(),this.getThicknessStock(),this.getHasGrain(),this.getHasEdgebands(),this.getHasLaminates(),this.getHasPrograms(),this.getHasProcessZones(),this.getListEdgebandMaterials(),this.getEdgingCode(),this.getEdgingCodeOrder(),this.getVolume(),this.getNameHead(),this.getNameTail(),this.getBoard(),this.getUrl(),this.getImages(),this.getPDFs(),this.getCost(),this.getCostCore(),this.getCostEdgebands(),this.getCostLaminates(),this.getCostPrograms(),this.getCostProcessZones(),this.getCombineId(),this.settings)}getLongest(s,t,e){return this.settings.LengthLongestEdge?e?{length:s,width:t}:t>s?{width:t,length:s}:{length:s,width:t}:{length:s,width:t}}getCoreStock(){for(const s of this.stocks)if(s.variables.ST_N==="CORE")return s}getHasGrain(){var t,e;const s=this.getCoreStock();return s&&(e=(t=s.material)==null?void 0:t.getHasGrain())!=null?e:!1}getNameTail(){const s=this.name.lastIndexOf("_");return s===-1?this.name:this.name.substring(s+1,this.name.length)}getNameHead(){const s=this.name.indexOf("_");return s===-1?this.name:this.name.substring(0,s)}};Ds.fromPanelData=(s,t)=>new Ds(s.key,s.name,s.refPrograms,s.refStocks,s.refProcessZones,s.refEdgeband,s.messages,s.documents,s.variables,t);let ht=Ds;class he extends C{constructor(){super(...arguments),this.addStocks=s=>{const t=this.getAll();for(const e of t)for(const a of e.refStocks){const i=s.get(a);i&&(e.stocks.push(i),i.variables.ST_N==="CORE"&&(e.material=i.material))}},this.addPrograms=s=>{const t=this.getAll();for(const e of t)for(const a of e.refPrograms){const i=s.get(a);i&&(e.programs.push(i),i.panel=e)}},this.addEdgebands=s=>{const t=this.getAll();for(const e of t)for(const a of e.refEdgebands){const i=s.get(a);i&&(e.edgebands.push(i),i.panel=e)}},this.addLaminates=s=>{const t=this.getAll();for(const e of t)for(const a of e.refStocks){const i=s.get(a);i&&(e.laminates.push(i),i.panel=e)}}}addInstances(s,t){for(const e of s)this.add(e.key,ht.fromPanelData(e,t));return this}}class Ke{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b,P,w){this.key=s,this.refPrograms=t,this.refStocks=e,this.refPanel=a,this.bodyCount=i,this.messages=o,this.variables=n,this.heritedVariables=r,this.typedObjectVariables=g,this.documents=d,this.swcps=h,this.name=c,this.description=m,this.configuration=f,this.quantity=u,this.height=p,this.width=b,this.depth=P,this.images=w,this.programs=[],this.stocks=[]}static fromPartBusiness(s){return s.createViewModel()}}const Ts=class Ts{constructor(s,t,e,a,i,o,n,r,g,d,h){this.key=s,this.refPrograms=t,this.refStocks=e,this.refPanel=a,this.bodyCount=i,this.messages=o,this.variables=n,this.heritedVariables=r,this.typedObjectVariables=g,this.documents=d,this.swcps=h,this.programs=[],this.stocks=[],this.getName=()=>{var c;return(c=this.variables.NAME)!=null?c:""},this.getDescription=()=>this.variables.Description,this.getConfiguration=()=>{var c;return(c=this.variables.CONF)!=null?c:""},this.getQuantity=()=>{var c;return(c=this.variables.NB)!=null?c:0},this.getImages=()=>new V(this.documents).getImages(),this.getCombinedId=()=>{var c;return(c=this.variables.CombineID)!=null?c:0}}createViewModel(){return new Ke(this.key,this.refPrograms,this.refStocks,this.refPanel,this.bodyCount,M.fromMessagesRaw(this.messages,this.getName(),"Part"),this.variables,this.heritedVariables,this.typedObjectVariables,this.documents,this.swcps,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),0,0,0,this.getImages())}};Ts.fromPartData=s=>new Ts(s.key,s.refPrograms,s.refStocks,s.refPanel,s.bodyCount,s.messages,s.variables,s.heritedVariables,s.typedObjectVariables,s.documents,s.swcps);let gt=Ts;class ge extends C{constructor(){super(...arguments),this.addStocks=s=>{var e;const t=this.getAll();for(const a of t)for(const i of(e=a.refStocks)!=null?e:[]){const o=s.get(i);o&&(a.stocks.push(o),o.part=a)}},this.addPrograms=s=>{const t=this.getAll();for(const e of t)for(const a of e.refPrograms){const i=s.get(a);i&&(e.programs.push(i),i.part=e)}}}addInstances(s){for(const t of s)this.add(t.key,gt.fromPartData(t));return this}}const Zt=class Zt{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b,P,w,T,v,I){this.key=s,this.refTools=t,this.programParts=e,this.nestingBoard=a,this.variables=i,this.messages=o,this.documents=n,this.name=r,this.description=g,this.configuration=d,this.quantity=h,this.length=c,this.width=m,this.thickness=f,this.url=u,this.cost=p,this.costHour=b,this.time=P,this.machine=w,this.images=T,this.programFilepath=v,this.programFile=I,this.tools=[]}};Zt.fromProgramBusiness=s=>s.createViewModel();let ts=Zt;const ks=class ks{constructor(s,t,e,a,i,o,n){this.key=s,this.refTools=t,this.programParts=e,this.nestingBoard=a,this.variables=i,this.messages=o,this.documents=n,this.tools=[],this.getName=()=>this.variables.PROG_PHASENAME,this.getDescription=()=>{var r,g;return(g=(r=this.part)==null?void 0:r.getDescription())!=null?g:""},this.getConfiguration=()=>{var r,g;return(g=(r=this.part)==null?void 0:r.getConfiguration())!=null?g:""},this.getQuantity=()=>{var r,g;return(g=(r=this.part)==null?void 0:r.getQuantity())!=null?g:0},this.getLength=()=>{var r;return(r=this.variables.PROGBX)!=null?r:0},this.getWidth=()=>{var r;return(r=this.variables.PROGBY)!=null?r:0},this.getThickness=()=>{var r;return(r=this.variables.PROGBZ)!=null?r:0},this.getUrl=()=>"programs/".concat(this.key),this.getImages=()=>new V(this.documents).getImages(),this.getCostHour=()=>{var r;return(r=this.variables.PROGMAC_HOURCOST)!=null?r:0},this.getTotalTime=()=>{var r;return(r=this.variables.PROGTPS)!=null?r:0},this.getCost=()=>this.getCostHour()*this.getTotalTime()/3600,this.getMachine=()=>{var r;return(r=this.variables.PROGMAC)!=null?r:""},this.getProgramFilepath=()=>{var r;return(r=this.variables.PROGPATH)!=null?r:""},this.getProgramFile=()=>{const r=this.documents.find(g=>g.objType==="PROGRAM"&&g.type===null&&g.docType===null);return r||console.warn("unable to find program file for program: ".concat(this.getName())),r}}createViewModel(){return new ts(this.key,this.refTools,this.programParts,this.nestingBoard,this.variables,M.fromMessagesRaw(this.messages,this.getName(),"Program",this.getUrl()),this.documents,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness(),this.getUrl(),this.getCost(),this.getCostHour(),this.getTotalTime(),this.getMachine(),this.getImages(),this.getProgramFilepath(),this.getProgramFile())}};ks.fromProgramData=s=>new ks(s.key,s.refTools,s.programParts,s.nestingBoard,s.variables,s.messages,s.documents);let ct=ks;class ce extends C{addInstances(s){for(const t of s)t.nestingBoard||this.add(t.key,ct.fromProgramData(t));return this}addTools(s){const t=this.getAll();for(const e of t)for(const a of e.refTools){const i=s.get(a);i&&e.tools.push(i)}}}const Qt=class Qt{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m){this.key=s,this.refPart=t,this.refProgram=e,this.documents=a,this.messages=i,this.variables=o,this.name=n,this.description=r,this.configuration=g,this.quantity=d,this.programPartId=h,this.angle=c,this.parent=m}};Qt.fromProgramPartBusiness=s=>s.createViewModel();let es=Qt;const Is=class Is{constructor(s,t,e,a,i,o){this.key=s,this.refPart=t,this.refProgram=e,this.documents=a,this.messages=i,this.variables=o,this.getName=()=>{var n;return(n=this.panel)==null?void 0:n.name},this.getDescription=()=>this.variables.PROGPART_NPARENTINDEX,this.getConfiguration=()=>this.variables.PROGPART_NPARENTINDEX,this.getQuantity=()=>0,this.getProgramPartId=()=>this.variables.PROGPART_ID,this.getAngle=()=>this.variables.PROGPART_NANGLE,this.getParentIndex=()=>this.variables.PROGPART_NPARENTINDEX,this.getParentName=()=>this.variables.PROGPART_NPARENTNAME,this.getParentPath=()=>this.variables.PROGPART_NPARENTPATH,this.getParentConfiguration=()=>this.variables.PROGPART_NPARENTCONFIG}createViewModel(){return new es(this.key,this.refPart,this.refProgram,this.documents,M.fromMessagesRaw(this.messages,this.getName(),"Program Part"),this.variables,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getProgramPartId(),this.getAngle(),{index:this.getParentIndex(),name:this.getParentName(),configuration:this.getParentConfiguration(),filepath:this.getParentPath()})}};Is.fromProgramPartData=s=>new Is(s.key,s.part,s.program,s.documents,s.messages,s.variables);let lt=Is;class le extends C{addInstances(s){for(const t of s)this.add(t.key,lt.fromProgramPartData(t));return this}}const vs=class vs{constructor(s,t,e,a){this.key=s,this.messages=t,this.documents=e,this.variables=a}};vs.fromSpindleData=s=>new vs(s.key,s.messages,s.documents,s.variables);let dt=vs;class de extends C{addInstances(s){if(!s)return this;for(const t of s)this.add(t.key,dt.fromSpindleData(t));return this}}var W;let mt=(W=class{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=o,this.name=n,this.description=r,this.configuration=g,this.quantity=d,this.length=h,this.width=c,this.thickness=m}},W.fromStockBusiness=s=>s.createViewModel(),W.createCombinedStock=(s,t,e)=>new W(s.key,s.refPart,s.refMaterial,s.messages,s.documents,s.variables,t,s.description,s.configuration,e,s.length,s.width,s.thickness),W);const Cs=class Cs{constructor(s,t,e,a,i,o){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=o,this.createViewModel=()=>new mt(this.key,this.refPart,this.refMaterial,M.fromMessagesRaw(this.messages,this.getName(),"Stock"),this.documents,this.variables,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getWidth(),this.getThickness()),this.getName=()=>{var n,r;return(r=(n=this.panel)==null?void 0:n.name)!=null?r:""},this.getDescription=()=>{var n,r;return(r=(n=this.part)==null?void 0:n.getDescription())!=null?r:""},this.getConfiguration=()=>{var n,r;return(r=(n=this.part)==null?void 0:n.getConfiguration())!=null?r:""},this.getQuantity=()=>{var n,r;return(r=(n=this.part)==null?void 0:n.getQuantity())!=null?r:0},this.getLength=()=>this.variables.ST_L,this.getWidth=()=>this.variables.ST_W,this.getThickness=()=>this.variables.ST_T}};Cs.fromStockData=s=>new Cs(s.key,s.refPart,s.refMaterial,s.messages,s.documents,s.variables);let ft=Cs;class me extends C{constructor(){super(...arguments),this.addMaterials=s=>{const t=this.getAll();for(const e of t){const a=s.get(e.refMaterial);a&&(e.material=a)}}}addInstances(s){for(const t of s)this.add(t.key,ft.fromStockData(t));return this}}const qt=class qt{constructor(s,t,e,a,i,o,n,r){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.name=i,this.reference=o,this.number=n,this.diameter=r}};qt.fromToolBusiness=s=>s.createViewModel();let as=qt;class Vt{constructor(s,t,e,a){this.key=s,this.variables=t,this.messages=e,this.documents=a,this.createViewModel=()=>new as(this.key,M.fromMessagesRaw(this.messages,this.getName(),"Tool"),this.documents,this.variables,this.getName(),this.getReference(),this.getNumber(),this.getDiameter()),this.getName=()=>this.variables.TOOL_NAME,this.getReference=()=>this.variables.TOOL_REFERENCE,this.getNumber=()=>this.variables.TOOL_DIAM,this.getDiameter=()=>this.variables.TOOL_NUMBER}static fromToolData(s){return new Vt(s.key,s.variables,s.messages,s.documents)}}class fe extends C{addInstances(s){for(const t of s)this.add(t.key,Vt.fromToolData(t));return this}}class ue{constructor(){this.instances=new Map}addInstance(s,t){const e=this.instances.get(s);e?e.push(t):this.instances.set(s,[t])}addInstances(s,t,e){for(const a of s.typedObjects){const i=t.get(a);if(i){const n=i.variables.TOTYPES.split(";");for(const r of n)this.addInstance(r,i)}const o=e.get(a);if(o){const n=o.variables.TOTYPES.split(";");for(const r of n)this.addInstance(r,o)}}return this}getInstancesByName(s){return this.instances.get(s)||void 0}getAll(){return this.instances}}const zt=class zt{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b,P,w,T){this.key=s,this.refTools=t,this.refProgramParts=e,this.nestingBoard=a,this.variables=i,this.messages=o,this.documents=n,this.name=r,this.quantity=g,this.programFilename=d,this.programFilepath=h,this.comments=c,this.totalParts=m,this.totalOffcuts=f,this.machine=u,this.length=p,this.width=b,this.thickness=P,this.url=w,this.images=T,this.tools=[],this.programParts=[]}};zt.fromProgramBusiness=s=>s.createViewModel();let is=zt;const As=class As{constructor(s,t,e,a,i,o,n){this.key=s,this.refTools=t,this.programParts=e,this.nestingBoard=a,this.variables=i,this.messages=o,this.documents=n,this.getName=()=>this.variables.PROG_PHASENAME,this.getQuantity=()=>this.variables.PROG_NSHEETQTY,this.getProgramFilename=()=>this.variables.PROGCFGFILE,this.getProgramFilepath=()=>this.variables.PROGCFGPATH,this.getProgramComment=()=>this.variables.PROGCOMMENT,this.getTotalParts=()=>this.variables.PROG_PARTCOUNT,this.getTotalOffcuts=()=>this.variables.PROG_OFFCUTCOUNT,this.getMachine=()=>this.variables.PROGMAC,this.getLength=()=>this.variables.PROGBX,this.getWidth=()=>this.variables.PROGBY,this.getThickness=()=>this.variables.PROGBZ,this.getUrl=()=>"sheets/".concat(this.key),this.getImages=()=>new V(this.documents).getImages()}createViewModel(){return new is(this.key,this.refTools,this.programParts,this.nestingBoard,this.variables,M.fromMessagesRaw(this.messages,this.getName(),"Sheet",this.getUrl()),this.documents,this.getName(),this.getQuantity(),this.getProgramFilename(),this.getProgramFilepath(),this.getProgramComment(),this.getTotalParts(),this.getTotalOffcuts(),this.getMachine(),this.getLength(),this.getWidth(),this.getThickness(),this.getUrl(),this.getImages())}};As.fromProgramData=s=>new As(s.key,s.refTools,s.programParts,s.nestingBoard,s.variables,s.messages,s.documents);let ut=As;class pe extends C{addInstances(s){for(const t of s)t.nestingBoard&&this.add(t.key,ut.fromProgramData(t));return this}}const Yt=class Yt{constructor(s,t,e,a,i,o,n,r,g,d,h,c){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.name=i,this.description=o,this.quantity=n,this.thickness=r,this.category=g,this.cost=d,this.costUnit=h,this.costType=c}};Yt.fromPanelProcessBusiness=s=>s.createViewModel();let pt=Yt;class xt{constructor(s,t,e,a,i){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.quantity=i,this.createViewModel=()=>new pt(this.key,M.fromMessagesRaw(this.messages,this.getName(),"Panel Process"),this.documents,this.variables,this.getName(),this.getDescription(),this.quantity,this.getThickness(),this.getCategory(),this.getCost(),this.getCostUnit(),this.getCostType()),this.getName=()=>this.variables.PROC_NAME,this.getDescription=()=>this.variables.PROC_DESC,this.getThickness=()=>this.variables.PROC_THICKNESS,this.getCategory=()=>this.variables.PROC_CAT,this.getCostUnit=()=>this.variables.PROC_UCOST,this.getCost=()=>this.quantity*this.getCostUnit(),this.getCostType=()=>this.variables.PROC_COSTTYPE}static fromPanelProcessData(s){return new xt(s.key,s.messages,s.documents,s.variables,0)}}class be extends C{addInstances(s){if(!s)return this;for(const t of s)this.add(t.key,xt.fromPanelProcessData(t));return this}}const Kt=class Kt{constructor(s,t,e,a,i,o,n,r,g,d,h){this.key=s,this.refPanel=t,this.refPanelProcess=e,this.messages=a,this.documents=i,this.variables=o,this.name=n,this.quantity=r,this.unitOfMeasure=g,this.cost=d,this.mask=h}};Kt.fromProcessZoneBusiness=s=>s.createViewModel();let bt=Kt;class Ft{constructor(s,t,e,a,i,o){this.key=s,this.refPanel=t,this.refPanelProcess=e,this.messages=a,this.documents=i,this.variables=o,this.createViewModel=()=>new bt(this.key,this.refPanel,this.refPanelProcess,M.fromMessagesRaw(this.messages,this.getName(),"Process Zone"),this.documents,this.variables,this.getName(),this.getQuantity(),this.getUnitOfMeasure(),this.getCost(),this.getMask()),this.getName=()=>this.variables.PROC_ZONENAME,this.getQuantity=()=>this.variables.PROC_ZONE_QTT,this.getUnitOfMeasure=()=>this.variables.PROC_ZONE_QTT_UNIT,this.getCost=()=>this.variables.PROC_ZONE_COST,this.getMask=()=>this.variables.PROC_ZONEMASK,this.getCostUnit=()=>this.panelProcess?this.panelProcess.getCostUnit():0,this.getCostType=()=>this.panelProcess?this.panelProcess.getCostType():0}static fromProcessZoneData(s){return new Ft(s.key,s.refPanel,s.refPanelProcess,s.messages,s.documents,s.variables)}}class Pe extends C{addInstances(s){if(!s)return this;for(const t of s)this.add(t.key,Ft.fromProcessZoneData(t));return this}}class Z{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=o,this.name=n,this.description=r,this.configuration=g,this.quantity=d,this.length=h,this.lengthTotal=c,this.width=m,this.thickness=f,this.angle1=u,this.angle2=p,this.cutlist=b,this.addChildren=P=>{this.children||(this.children=[]),this.children.push(P)}}static fromWeldmentBusiness(s){return s.createViewModel()}static fromWeldmentBusinessChild(s){return s.createViewModelChild()}}const Bs=class Bs{constructor(s,t,e,a,i,o){this.key=s,this.refPart=t,this.refMaterial=e,this.messages=a,this.documents=i,this.variables=o,this.getName=()=>{var n;return(n=this.variables.ST_N)!=null?n:""},this.getDescription=()=>{var n;return(n=this.variables.MBS_Description)!=null?n:""},this.getConfiguration=()=>{var n,r;return(r=(n=this.part)==null?void 0:n.getConfiguration())!=null?r:""},this.getPartQuantity=()=>{var n,r;return(r=(n=this.part)==null?void 0:n.getQuantity())!=null?r:0},this.getQuantity=()=>{var n;return(n=this.variables.MBS_Quantity)!=null?n:0*this.getPartQuantity()},this.getLength=()=>this.variables.MBS_Length,this.getLengthTotal=()=>this.variables.MBS_TotalLength,this.getWidth=()=>this.variables.ST_W,this.getThickness=()=>this.variables.ST_T,this.getAngle1=()=>{var n;return(n=this.variables.MBS_Angle1)!=null?n:""},this.getAngle2=()=>{var n;return(n=this.variables.MBS_Angle2)!=null?n:""},this.getCutlist=()=>{var n;return(n=this.variables.MBS_Cutlist)!=null?n:""}}createViewModel(){return new Z(this.key,this.refPart,this.refMaterial,M.fromMessagesRaw(this.messages,this.getName(),"Weldment"),this.documents,this.variables,this.getCutlist(),this.getDescription(),this.getConfiguration(),this.getQuantity(),this.getLength(),this.getLengthTotal(),this.getWidth(),this.getThickness(),this.getAngle1(),this.getAngle2(),this.getCutlist())}createViewModelChild(){return new Z(this.key,this.refPart,this.refMaterial,M.fromMessagesRaw(this.messages,this.getName(),"Weldment"),this.documents,this.variables,this.getName(),this.getDescription(),this.getConfiguration(),1,this.getLength(),this.getLengthTotal(),this.getWidth(),this.getThickness(),this.getAngle1(),this.getAngle2(),this.getCutlist())}};Bs.fromStockData=s=>new Bs(s.key,s.refPart,s.refMaterial,s.messages,s.documents,s.variables);let Pt=Bs;class Me extends C{addInstances(s){var t;for(const e of s)(t=e.material)!=null&&t.variables.WELDMENT&&this.add(e.key,Pt.fromStockData(e));return this}}class Xe{constructor(s,t,e,a,i,o,n,r,g,d,h,c){this.key=s,this.messages=t,this.documents=e,this.variables=a,this.name=i,this.description=o,this.cost=n,this.costUnit=r,this.costType=g,this.quantity=d,this.type=h,this.unitOfMeasure=c}static fromMaterialBusiness(s){return s.createViewModel()}}const Ss=class Ss{constructor(s,t,e,a,i,o){this.key=s,this.description=t,this.messages=e,this.documents=a,this.variables=i,this.quantity=o,this.createViewModel=()=>new Xe(this.key,M.fromMessagesRaw(this.messages,this.getName(),"Weldment Material"),this.documents,this.variables,this.getName(),this.description,this.getCost(),this.getCostUnit(),this.getCostType(),this.quantity,this.getType(),this.getUnitOfMeasure()),this.getName=()=>{var n;return(n=this.variables.MAT_NAME)!=null?n:""},this.getDescription=()=>{var n;return(n=this.variables.MAT_DESC)!=null?n:""},this.getCostUnit=()=>{var n;return(n=this.variables.MAT_UCOST)!=null?n:0},this.getCostType=()=>{var n;return(n=this.variables.MAT_COSTTYPE)!=null?n:0},this.getBoardLength=()=>{var n;return(n=this.variables.BOARD_LENGTH)!=null?n:0},this.getBoardWidth=()=>{var n;return(n=this.variables.BOARD_WIDTH)!=null?n:0},this.getUnitOfMeasure=()=>{switch(this.getCostType()){case 0:return"m³";case 1:return"m²";case 2:return"m";case 3:return"unit";default:return"unknown"}},this.getCost=()=>this.quantity*this.getCostUnit(),this.getType=()=>{var n;return(n=this.variables.MAT_TYPE)!=null?n:0},this.getIsWeldment=()=>{var n;return(n=this.variables.WELDMENT)!=null?n:!1}}};Ss.fromMaterialData=(s,t)=>new Ss("".concat(s.key,"-").concat(t.getDescription()," "),t.getDescription(),s.messages,s.documents,s.variables,t.getLengthTotal()/1e3);let Mt=Ss;class we extends C{addInstances(s,t){for(const e of t){const a=s.get(e.refMaterial);if(a&&a.getIsWeldment()){const i=Mt.fromMaterialData(a,e);this.add(i.key,i)}}return this}}const Xt=class Xt{constructor(s,t,e,a,i,o,n,r,g){this.key=s,this.messages=t,this.documents=e,this.swcps=a,this.variables=i,this.name=o,this.description=n,this.configuration=r,this.quantity=g}};Xt.fromExcludedBusiness=s=>s.createViewModel();let ns=Xt;const Es=class Es{constructor(s,t,e,a,i,o,n,r,g){this.key=s,this.messages=t,this.heritedVariables=e,this.typedObjectVariables=a,this.refParts=i,this.refAssemblies=o,this.documents=n,this.swcps=r,this.variables=g,this.parts=[],this.assemblies=[],this.getName=()=>this.variables.NAME,this.getDescription=()=>this.variables.Description,this.getConfiguration=()=>this.variables.CONF,this.getQuantity=()=>this.variables.NB}createViewModel(){return new ns(this.key,M.fromMessagesRaw(this.messages,this.getName(),"Excluded"),this.documents,this.swcps,this.variables,this.getName(),this.getDescription(),this.getConfiguration(),this.getQuantity())}};Es.fromAssemblyPartBusiness=s=>new Es(s.key,s.messages,s.heritedVariables,s.typedObjectVariables,"refParts"in s?s.refParts:[],"refAssemblies"in s?s.refAssemblies:[],s.documents,s.swcps,s.variables);let wt=Es;class ye extends y{constructor(){super(...arguments),this.FrameTypedObjectName="EXCLUDED"}addInstances(s){var e;const t=(e=s.getInstancesByName(this.FrameTypedObjectName))!=null?e:[];for(const a of t)this.addInstance(a.key,wt.fromAssemblyPartBusiness(a));return this}}class rs{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b,P,w,T,v,I,A,S,E,k,N,L,x,F,U,Ls,Os,Ws,Vs,xs,Fs,Us,Hs,js,Gs,$s,Zs,Qs,qs,zs){this.database=s,this.settings=t,this.projectBusiness=e,this.panelsBusiness=a,this.stocksBusiness=i,this.laminatesBusiness=o,this.partsBusiness=n,this.assembliesBusiness=r,this.edgebandsBusiness=g,this.edgebandMaterialsBusiness=d,this.materialsBusiness=h,this.weldmentMaterialsBusiness=c,this.programsBusiness=m,this.sheetBusiness=f,this.programPartsBusiness=u,this.toolsBusiness=p,this.spindlesBusiness=b,this.costsBusiness=P,this.typedObjectsBusiness=w,this.framesBusiness=T,this.hardwaresBusiness=v,this.excludedItemsBusiness=I,this.panelProcessesBusiness=A,this.processZonesBusiness=S,this.weldmentsBusiness=E,this.panelBusinessManager=k,this.stockBusinessManager=N,this.laminateBusinessManager=L,this.partBusinessManager=x,this.assemblyBusinessManager=F,this.edgebandBusinessManager=U,this.edgebandMaterialBusinessManager=Ls,this.materialBusinessManager=Os,this.weldmentMaterialBusinessManager=Ws,this.programBusinessManager=Vs,this.sheetBusinessManager=xs,this.programPartBusinessManager=Fs,this.toolBusinessManager=Us,this.spindleBusinessManager=Hs,this.costBusinessManager=js,this.frameBusinessManager=Gs,this.hardwareBusinessManager=$s,this.excludedBusinessManager=Zs,this.panelProcessBusinessManager=Qs,this.processZoneBusinessManager=qs,this.weldmentBusinessManager=zs}static createFromRawDataNew(s,t){const e=X.createFromRawData(s),a=J.fromProjectData(e.projectData),i=new re;i.addInstances(e.materialsData);const o=new fe;o.addInstances(e.toolsData);const n=new ce;n.addInstances(e.programsData),n.addTools(o);const r=new me;r.addInstances(e.stocksData),r.addMaterials(i);const g=new ge;g.addInstances(e.partsData),g.addStocks(r),g.addPrograms(n);const d=new _t;d.addInstances(e.assembliesData),d.addPrograms(n),d.addParts(g),d.addAssemblies(d);const h=new ne;h.addInstances(e.stocksData,t);const c=new ee;c.addInstances(e.edgebandMaterialsData);const m=new te;m.addInstances(e.edgebandsData),m.addMaterials(c);const f=new pe().addInstances(e.programsData),u=new le().addInstances(e.programPartsData),p=new de().addInstances(e.spindlesData),b=new se().addInstances(e.costsData),P=new ue().addInstances(s,g,d),w=new ae().addInstances(P),T=new ie().addInstances(P),v=new ye().addInstances(P),I=new be().addInstances(e.panelProcessesData),A=new Pe().addInstances(e.processZonesData),S=new Me().addInstances(e.stocksData),E=new we().addInstances(i,S.getAll()),k=new he;return k.addInstances(e.panelsData,t),k.addStocks(r),k.addEdgebands(m),k.addLaminates(h),k.addPrograms(n),new rs(s,t,a,k.getAll(),r.getAll(),h.getAll(),g.getAll(),d.getAll(),m.getAll(),c.getAll(),i.getAll(),E.getAll(),n.getAll(),f.getAll(),u.getAll(),o.getAll(),p.getAll(),b.getAll(),P.getAll(),w.getAll(),T.getAll(),v.getAll(),I.getAll(),A.getAll(),S.getAll(),k,r,h,g,d,m,c,i,E,n,f,u,o,p,b,w,T,v,I,A,S)}static createFromRawData(s,t){const e=X.createFromRawData(s),a=J.fromProjectData(e.projectData),i=new re().addInstances(e.materialsData),o=new ce().addInstances(e.programsData),n=new ge().addInstances(e.partsData),r=new _t().addInstances(e.assembliesData),g=new he().addInstances(e.panelsData,t),d=new me().addInstances(e.stocksData),h=new ne().addInstances(e.stocksData,t),c=new te().addInstances(e.edgebandsData),m=new ee().addInstances(e.edgebandMaterialsData),f=new pe().addInstances(e.programsData),u=new le().addInstances(e.programPartsData),p=new fe().addInstances(e.toolsData),b=new de().addInstances(e.spindlesData),P=new se().addInstances(e.costsData),w=new ue().addInstances(s,n,r),T=new ae().addInstances(w),v=new ie().addInstances(w),I=new ye().addInstances(w),A=new be().addInstances(e.panelProcessesData),S=new Pe().addInstances(e.processZonesData),E=new Me().addInstances(e.stocksData),k=new we().addInstances(i,E.getAll());return new rs(s,t,a,g.getAll(),d.getAll(),h.getAll(),n.getAll(),r.getAll(),c.getAll(),m.getAll(),i.getAll(),k.getAll(),o.getAll(),f.getAll(),u.getAll(),p.getAll(),b.getAll(),P.getAll(),w.getAll(),T.getAll(),v.getAll(),I.getAll(),A.getAll(),S.getAll(),E.getAll(),g,d,h,n,r,c,m,i,k,o,f,u,p,b,P,T,v,I,A,S,E).relateData()}relateData(){return this.assignDataToProject(),this.assignDataToEdgebands(),this.assignDataToStocks(),this.assignDataToWeldments(),this.assignDataToLaminates(),this.assignDataToPanels(),this.assignDataToAssemblies(),this.assignSubAssemblies(),this.assignDataToFrames(),this.assignDataToParts(),this.assignDataToProgramParts(),this.assignDataToProcessZones(),this}assignDataToProject(){for(const s of this.assemblyBusinessManager.getAll())if(this.projectBusiness.name===s.getName()){this.projectBusiness.component=s;return}for(const s of this.partBusinessManager.getAll())if(this.projectBusiness.name===s.getName()){this.projectBusiness.component=s;return}}assignDataToEdgebands(){for(const s of this.edgebandBusinessManager.getAll())s.material=this.edgebandMaterialBusinessManager.get(s.refMaterial),s.part=this.partBusinessManager.get(s.refPanel),s.panel=this.panelBusinessManager.get(s.refPanel)}assignDataToStocks(){for(const s of this.stockBusinessManager.getAll())s.material=this.materialBusinessManager.get(s.refMaterial),s.part=this.partBusinessManager.get(s.refPart),s.panel=this.panelBusinessManager.get(s.refPart)}assignDataToWeldments(){for(const s of this.weldmentBusinessManager.getAll())s.material=this.weldmentMaterialBusinessManager.get(s.refMaterial),s.part=this.partBusinessManager.get(s.refPart)}assignDataToLaminates(){for(const s of this.laminateBusinessManager.getAll())s.material=this.materialBusinessManager.get(s.refMaterial),s.part=this.partBusinessManager.get(s.refPart),s.panel=this.panelBusinessManager.get(s.refPart)}assignDataToPanels(){for(const s of this.panelBusinessManager.getAll()){s.project=this.projectBusiness;const t=this.partBusinessManager.get(s.key);t&&(s.part=t);for(const e of s.refStocks){const a=this.stockBusinessManager.get(e);a&&(s.stocks.push(a),a.variables.ST_N==="CORE"&&(s.material=a.material));const i=this.laminateBusinessManager.get(e);i&&s.laminates.push(i)}for(const e of s.refEdgebands){const a=this.edgebandBusinessManager.get(e);a&&s.edgebands.push(a)}for(const e of s.refPrograms){const a=this.programBusinessManager.get(e);a&&s.programs.push(a)}for(const e of s.refProcessZones){const a=this.processZoneBusinessManager.get(e);a&&s.processZones.push(a)}}}assignDataToAssemblies(){var s,t;for(const e of this.assemblyBusinessManager.getAll()){for(const a of e.refParts){const i=this.partBusinessManager.get(a);i&&((s=e.parts)==null||s.push(i))}for(const a of e.refPrograms){const i=this.programBusinessManager.get(a);i&&((t=e.programs)==null||t.push(i))}}}assignSubAssemblies(){var s;for(const t of this.assemblyBusinessManager.getAll())for(const e of t.refAssemblies){const a=this.assemblyBusinessManager.get(e);a&&((s=t.assemblies)==null||s.push(a))}}assignDataToFrames(){var s,t;for(const e of this.frameBusinessManager.getAll()){for(const a of e.refParts){const i=this.partBusinessManager.get(a);i&&((s=e.parts)==null||s.push(i));const o=this.panelBusinessManager.get(a);if(o){(t=e.panels)==null||t.push(o);for(const r of o.programs)e.programs.push(r)}const n=this.hardwareBusinessManager.get(a);n&&e.hardware.push(n)}for(const a of e.refAssemblies){const i=this.assemblyBusinessManager.get(a);i&&e.assemblies.push(i);const o=this.hardwareBusinessManager.get(a);o&&e.hardware.push(o)}}}assignDataToParts(){var s;for(const t of this.partBusinessManager.getAll()){t.panel=t.refPanel?this.panelBusinessManager.get(t.refPanel):void 0;for(const e of(s=t.refStocks)!=null?s:[]){const a=this.stockBusinessManager.get(e);a&&t.stocks.push(a)}for(const e of t.refPrograms){const a=this.programBusinessManager.get(e);a&&(t.programs.push(a),a.part=t)}}}assignDataToProgramParts(){for(const s of this.programPartsBusiness){const t=this.panelBusinessManager.get(s.refPart);s.panel=t!=null?t:void 0}}assignDataToProcessZones(){for(const s of this.processZonesBusiness){const t=this.panelProcessBusinessManager.get(s.refPanelProcess);s.panelProcess=t}}}class De extends y{addInstances(s){for(const t of s)this.addInstance(t.key,Qe.fromAssemblyBusiness(t));return this}}class Ut{constructor(s,t){this.articles=s,this.cost=t}static fromCostBusiness(s){return new Ut(s.articles,s.cost)}}class Te extends y{addInstances(s){return this.addInstance("0",Ut.fromCostBusiness(s[0])),this}}class yt{constructor(s){this.cuts=[],this.length=s.length,this.width=s.width,this.cutDirection=s.cutDirection,this.coordinate=s.cutCoordinate,this.stockLeft=s.stockLeft?s.stockLeft:null,this.stockRight=s.stockRight?s.stockRight:null}}class ya{constructor(s,t){this.cutterThickness=0,this.cuts=[],this.trims=[],this.waste=[],this.name=s.name,this.key=s.name,this.material=s.material,this.stock=s.stock,this.length=s.stock.length,this.width=s.stock.width,this.cutterThickness=s.stock.cutterThickness*2,this.panels=t,this.url="cutting-pattern-details/".concat(this.name)}getCuts(s){return s||(s=this.stock),this.cuts.push(new yt(s)),s.stockLeft&&this.getCuts(s.stockLeft),s.stockRight&&this.getCuts(s.stockRight),this.cuts}getItems(s=!1){const t=this.getFlattenedTreeStructure(s),e=[];for(const a of t)a.type&&e.push(a);return e}getPanels(s=!1){const t=this.getFlattenedTreeStructure(s),e=[];for(const a of t)a.type==="item"&&e.push(a);return e}getTrims(s=!1){const t=this.getFlattenedTreeStructure(s),e=[];for(const a of t)(a.type==="trimming"||a.type==="padding")&&e.push(a);return e}getWaste(s=!1){const t=this.getFlattenedTreeStructure(s),e=[];for(const a of t)a.type==="waste"&&e.push(a);return e}getTreeStructure(s=!1){const t=this.stock.getTreeStructure();return s&&this.reverseChildren(t),this.assignIndexes(t)}getFlattenedTreeStructure(s=!1){const t=this.getTreeStructure(s),e=[];return this.flattenTree(t,e),e}getTotalArea(s){const t=this.length*this.width/1e6;return s?parseFloat(t.toFixed(2)):t}getPanelArea(s){const t=this.getPanels();let e=0;for(const i of t)e+=i.length*i.width;const a=e/1e6;return s?parseFloat(a.toFixed(2)):a}getPanelAreaPercentage(s){const t=this.getPanelArea()/this.getTotalArea()*100;return s?parseFloat(t.toFixed(2)):t}getWasteArea(s){const t=this.getWaste();let e=0;for(const i of t)e+=i.length*i.width;const a=e/1e6;return s?parseFloat(a.toFixed(2)):a}getWasteAreaPercentage(s){const t=this.getWasteArea()/this.getTotalArea()*100;return s?parseFloat(t.toFixed(2)):t}getTrimArea(s){const t=this.getTrims();let e=0;for(const i of t)e+=i.length*i.width;const a=e/1e6;return s?parseFloat(a.toFixed(2)):a}getTrimAreaPercentage(s){const t=this.getTrimArea()/this.getTotalArea()*100;return s?parseFloat(t.toFixed(2)):t}getFirstTrimSize(s=this.stock){if(s.type==="trimming"||s.type==="padding")return s.parent.cutCoordinate;if(s.stockLeft)return this.getFirstTrimSize(s.stockLeft);if(s.stockRight)return this.getFirstTrimSize(s.stockRight)}getThickness(){const t=this.getPanels()[0].name;for(const e of this.panels)if(e.name===t)return e.thickness;return 0}getProcessedPanels(){const s=[],t=this.getPanels();for(const e of t){const a=this.panels.find(i=>i.name===e.name);a&&s.push(a)}return s}getProcessedPanelField(s,t){const e=this.panels.find(a=>a.name===s);if(e){const a=e[t];if(typeof a=="number")return a.toString();if(typeof a=="string")return a}return""}assignIndexes(s,t={index:0,panelIndex:0}){s.index=t.index++,s.type==="item"&&(s.indexPanel=t.panelIndex++);for(const e of s.children)this.assignIndexes(e,t);return s}flattenTree(s,t){if(t.push(s),s.children)for(const e of s.children)this.flattenTree(e,t)}reverseChildren(s){if(s.children){s.children.reverse();for(const t of s.children)this.reverseChildren(t)}}}class Ht{constructor(s){var t,e;this.indexParent=-1,this.children=[],this.cuts=[],this.parent=null,this.quantity=1,this.stock=s,this.type=s.type,this.length=s.length,this.width=s.width,this.grain=s.grain,this.cutDirection=s.cutDirection,this.cutterThickness=s.cutterThickness,this.name=(e=(t=s.name)!=null?t:s.type)!=null?e:"group",this.cutCoordinate=s.cutCoordinate,this.x=s.x,this.y=s.y,this.parent=s.parent?new Ht(s.parent):null}}class os{constructor(s){var t,e;this.parent=null,this.index=0,this.indexPanel=0,this.indexParent=-1,this.children=[],this.cuts=[],this.stock=s,this.type=s.type,this.length=s.length,this.width=s.width,this.grain=s.grain,this.cutDirection=s.cutDirection,this.cutterThickness=s.cutterThickness,this.name=(e=(t=s.name)!=null?t:s.type)!=null?e:"group",this.cutCoordinate=s.cutCoordinate,this.x=s.x,this.y=s.y,this.parent=s.parent?new os(s.parent):null}getTrimSide(s){for(const t of this.children)if(t.type==="trimming"||t.type==="padding"){if(s==="length"&&this.cutDirection==="V")return this.cutCoordinate;if(s==="width"&&this.cutDirection==="H")return this.cutCoordinate}return 0}getGroupedNodes(){const s=[];for(const t of this.children){const e=new Ht(t.stock);this.isPreviousEqual(e,s[s.length-1])?s[s.length-1].quantity++:s.push(e)}return s}isPreviousEqual(s,t){return t?s.length===t.length&&s.width===t.width&&s.type===t.type:!1}}class hs{constructor(s,t=null,e=0,a=0){this.type=s.type,this.length=s.length*1e3,this.width=s.width*1e3,this.cutDirection=s.cut,this.name=s["panel-name"]!=""?s["panel-name"]:null,this.cutCoordinate=s["cut-coordinate"]*1e3,this.grain=s["grain-direction"],this.cutterThickness=s["cut-half-thickness"]*2*1e3,this.parent=t,this.x=e,this.y=a;let i=0,o=0,n=0,r=0;s.cut==="V"&&(n=this.x+this.cutCoordinate+this.cutterThickness,r=this.y,i=this.x,o=this.y),s.cut==="H"&&(n=this.x,r=this.y+this.cutCoordinate+this.cutterThickness,i=this.x,o=this.y),this.stockLeft=s["left-stock"]?new hs(s["left-stock"],this,i,o):null,this.stockRight=s["right-stock"]?new hs(s["right-stock"],this,n,r):null}getTreeStructure(){const s=new os(this),t=this.findChildren(s,this.stockLeft),e=this.findChildren(s,this.stockRight);s.children=[...t,...e];const a=new yt(this),i=this.findCuts(a,this.stockLeft),o=this.findCuts(a,this.stockRight);return s.cuts=[...i,...o],s}findChildren(s,t){if(!t)return[];const e=new os(t);if(e.indexParent=s.index,t.type===null){if(s.cutDirection===t.cutDirection){const o=this.findChildren(s,t.stockLeft),n=this.findChildren(s,t.stockRight);return[...o,...n]}const a=this.findChildren(e,t.stockLeft),i=this.findChildren(e,t.stockRight);e.children=[...a,...i]}return[e]}findCuts(s,t){if(!t)return[];const e=new yt(t);if(t.type===null){if(s.cutDirection===t.cutDirection){const o=this.findCuts(s,t.stockLeft),n=this.findCuts(s,t.stockRight);return[...o,...n]}const a=this.findCuts(e,t.stockLeft),i=this.findCuts(e,t.stockRight);e.cuts=[...a,...i]}return[e]}}const Rs=class Rs{constructor(s,t){var e;this.boards=[];for(const a of(e=s.stocks)!=null?e:[]){const i=new ya({name:"Board ".concat((++Rs.boardIndex).toString()),material:s.material,stock:new hs(a)},t);this.boards.push(i)}}};Rs.boardIndex=0;let Dt=Rs;class Da{constructor(s,t){this.boards=[];for(const e of s.cuttingPattern){const a=new Dt(e,t);for(const i of a.boards)this.boards.push(i)}}}class ke{constructor(){this.boards=[]}createFromData(s,t){const e=new Da(s,t);return this.boards=e.boards,this}}class Ie extends y{constructor(){super(...arguments),this.getGroupKey=s=>{var t;return"".concat(s.length,"_").concat(s.width,"_").concat(s.thickness,"_").concat((t=s.material)==null?void 0:t.name)},this.getAllCombined=()=>{const s=new Map;for(const a of this.instances.values()){const i=this.getGroupKey(a);s.has(i)||s.set(i,[]),s.get(i).push(a)}const t=new Map;let e=1;for(const[,a]of s)if(a.length===1){const i=a[0];t.set(i.name,i)}else{const i=a[0],o=a.reduce((r,g)=>r+g.quantity,0),n=z.createCombinedEdgeband(i,"Combined Edgeband ".concat(e++),o);n.children=a,n.part=i.part,n.panel=i.panel,n.material=i.material,t.set(n.name,n)}return Array.from(t.values())}}addInstances(s){for(const t of s)this.addInstance(t.key,z.fromEdgebandBusiness(t));return this}}class ve extends y{addInstances(s){for(const t of s)this.addInstance(t.key,ze.fromEdgebandMaterialBusiness(t));return this}}class Ta extends y{constructor(){super(...arguments),this.FrameTypedObjectName="EXCLUDED"}addInstances(s){for(const t of s)this.addInstance(t.key,ns.fromExcludedBusiness(t));return this}}class Ce extends y{constructor(){super(...arguments),this.FrameTypedObjectName="FRAME"}addInstances(s){for(const t of s)this.addInstance(t.key,_.fromFrameBusiness(t));return this}}class Ae extends y{constructor(){super(...arguments),this.FrameTypedObjectName="HARDWARE"}addInstances(s){for(const t of s)this.addInstance(t.key,ss.fromHardwareBusiness(t));return this}}const O=class O{static makeLabels(s,t=!1){const e=[];return s.forEach(a=>{t?!a.children||a.children.length===0?O.pushLabel(a,e):a.children.forEach(i=>{O.pushCombinedLabel(i,e)}):O.pushLabel(a,e)}),e}static pushCombinedLabel(s,t){for(let e=0;e<s.quantity;e++){const a=this.clone(s);a.instance=e+1,a.combineId!==0&&(a.name="Combined Panel ".concat(a.combineId)),t.push(a)}}static pushLabel(s,t){for(let e=0;e<s.quantity;e++){const a=this.clone(s);a.instance=e+1,t.push(a)}}static clone(s){return Object.assign(Object.create(Object.getPrototypeOf(s)),s)}};O.deepCopy=s=>{if(s==null)return s;if(s instanceof Date)return new Date(s.getTime());if(Array.isArray(s))return s.map(t=>O.deepCopy(t));if(typeof s=="object"){const t={};for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e)){const a=s[e];t[e]=O.deepCopy(a)}return t}return s};let j=O;class Be extends y{constructor(){super(...arguments),this.combinedInstances=new Map,this.getLongest=(s,t,e)=>e?{length:s,width:t}:t>s?{width:t,length:s}:{length:s,width:t},this.getGroupKey=s=>{var a,i,o,n,r;const{length:t,width:e}=this.getLongest(s.length,s.width,(i=(a=s.material)==null?void 0:a.hasGrain)!=null?i:!1);return"".concat(t,"_").concat(e,"_").concat(s.thickness,"_").concat((n=(o=s.material)==null?void 0:o.hasGrain)!=null?n:!1,"_").concat((r=s.material)==null?void 0:r.name)},this.getAllCombined=()=>{const s=new Map;for(const a of this.instances.values()){const i=this.getGroupKey(a);s.has(i)||s.set(i,[]),s.get(i).push(a)}const t=new Map;let e=1;for(const[,a]of s)if(a.length===1){const i=a[0];t.set(i.name,i)}else{const i=a[0],o=a.reduce((r,g)=>r+g.quantity,0),n=Y.createCombinedLaminate(i,"Combined Laminate ".concat(e++),o);n.children=a,n.part=i.part,n.panel=i.panel,n.material=i.material,t.set(n.name,n)}return Array.from(t.values())}}addInstances(s){for(const t of s)this.addInstance(t.key,Y.fromLaminateBusiness(t));return this}}class Se extends y{addInstances(s){for(const t of s)t.getIsWeldment()||this.addInstance(t.key,Ye.fromMaterialBusiness(t));return this}}class Ee extends y{addInstances(s,t){for(const e of t)this.addInstance("".concat(s,"-").concat(e.messageType),e);return this}processMessages(s,t,e,a,i,o,n,r,g,d,h,c,m){this.processProjectMessages(s),this.processSourceMessages(t),this.processSourceMessages(e),this.processSourceMessages(a),this.processSourceMessages(i),this.processSourceMessages(o),this.processSourceMessages(n),this.processSourceMessages(r),this.processSourceMessages(g),this.processSourceMessages(d),this.processSourceMessages(h),this.processSourceMessages(c),this.processSourceMessages(m),this.processPanelMessages(t)}processSourceMessages(s){for(const t of s)this.addInstances(t.key,t.messages)}processProjectMessages(s){this.addInstances(s.name,s.messages)}processPanelMessages(s){for(const t of s)this.processPanelSize(t),this.processPanelLength(t),this.processPanelWidth(t)}processPanelSize(s){if(s.hasGrain===!1&&s.board.length>0&&s.board.width>0){const t=s.lengthStock<=s.board.length&&s.widthStock<=s.board.width,e=s.lengthStock<=s.board.width&&s.widthStock<=s.board.length;if(!t&&!e){const a=new M("ERROR","Error","size out of range. Panel Size: ".concat(s.lengthStock," x ").concat(s.widthStock," | Board: ").concat(s.board.length," x ").concat(s.board.width),"size out of range. Panel Size: ".concat(s.lengthStock," x ").concat(s.widthStock," | Board: ").concat(s.board.length," x ").concat(s.board.width),s.name,s.name,"Panel",s.url);this.addInstance("".concat(s.key,"-").concat(a.message),a),s.messages.push(a)}}}processPanelLength(s){if(s.board.length<s.lengthStock&&s.board.length>0&&s.hasGrain){const t=new M("ERROR","Error","length out of range. Length: ".concat(s.lengthStock," | Board: ").concat(s.board.length," x ").concat(s.board.width),"length out of range. Length: ".concat(s.lengthStock," | Board: ").concat(s.board.length," x ").concat(s.board.width),s.name,s.name,"Panel",s.url);this.addInstance("".concat(s.key,"-").concat(t.message),t),s.messages.push(t)}}processPanelWidth(s){if(s.board.width<s.widthStock&&s.board.width>0&&s.hasGrain){const t=new M("ERROR","Error","width out of range. Width: ".concat(s.widthStock," | Board: ").concat(s.board.length," x ").concat(s.board.width),"width out of range. Width: ".concat(s.widthStock," | Board: ").concat(s.board.length," x ").concat(s.board.width),s.name,s.name,"Panel",s.url);this.addInstance("".concat(s.key,"-").concat(t.message),t),s.messages.push(t)}}}class Re extends y{addInstances(s){for(const t of s)if(t.getCombineId()===0)this.addInstance(t.key,t.createViewModel());else{const e="Combined Panel ".concat(t.getCombineId()),a=this.instances.get(e);if(a){const i=t.createViewModel();a.addChildren(i),a.quantity+=i.quantity}else{const i=t.createCombinedViewModel();i.addChildren(t.createViewModel()),this.addInstance(i.key,i)}}return this}get(s){var e;const t=this.instances.get(s);if(t)return t;for(const a of this.instances.values())for(const i of(e=a.children)!=null?e:[])if(i.key===s)return a}}class Ne extends y{addInstances(s){for(const t of s)this.addInstance(t.key,t.createViewModel());return this}}class Le extends y{addInstances(s){for(const t of s)this.addInstance(t.key,Ke.fromPartBusiness(t));return this}}class Oe extends y{addInstances(s){for(const t of s)this.addInstance(t.key,t.createViewModel());return this}}class We extends y{addInstances(s){for(const t of s)t.nestingBoard||this.addInstance(t.key,ts.fromProgramBusiness(t));return this}}class Ve extends y{addInstances(s){for(const t of s)this.addInstance(t.key,es.fromProgramPartBusiness(t));return this}}class xe extends y{addInstances(s){for(const t of s)t.nestingBoard&&this.addInstance(t.key,is.fromProgramBusiness(t));return this}}const Ns=class Ns{constructor(s,t,e,a){this.key=s,this.messages=t,this.documents=e,this.variables=a}};Ns.fromSpindleBusiness=s=>new Ns(s.key,M.fromMessagesRaw(s.messages,s.key,"Spindle",""),s.documents,s.variables);let Tt=Ns;class Fe extends y{addInstances(s){if(!s)return this;for(const t of s)this.addInstance(t.key,Tt.fromSpindleBusiness(t));return this}}class Ue extends y{constructor(){super(...arguments),this.combinedInstances=new Map,this.getLongest=(s,t,e)=>e?{length:s,width:t}:t>s?{width:t,length:s}:{length:s,width:t},this.getGroupKey=s=>{var a,i,o,n,r;const{length:t,width:e}=this.getLongest(s.length,s.width,(i=(a=s.material)==null?void 0:a.hasGrain)!=null?i:!1);return"".concat(t,"_").concat(e,"_").concat(s.thickness,"_").concat((n=(o=s.material)==null?void 0:o.hasGrain)!=null?n:!1,"_").concat((r=s.material)==null?void 0:r.name)},this.getAllNOTINUSEBREAKINGMATERIALS=()=>{const s=new Map;for(const a of this.instances.values()){const i=this.getGroupKey(a);s.has(i)||s.set(i,[]),s.get(i).push(a)}const t=new Map;let e=1;for(const[,a]of s)if(a.length===1){const i=a[0];t.set(i.name,i)}else{const i=a[0],o=a.reduce((r,g)=>r+g.quantity,0),n=mt.createCombinedStock(i,"Combined Stock ".concat(e++),o);n.children=a,n.part=i.part,n.panel=i.panel,n.material=i.material,t.set(n.name,n)}return Array.from(t.values())}}addInstances(s){var t,e;for(const a of s)(t=a.material)!=null&&t.getIsWeldment()||((e=a.material)==null?void 0:e.getType())===0&&this.addInstance(a.key,mt.fromStockBusiness(a));return this}}class ka{constructor(){this.materials=new Map,this.laminates=new Map,this.edgebands=new Map,this.hardware=new Map,this.programs=new Map,this.weldments=new Map,this.panelProcesses=new Map,this.getMaterials=()=>Array.from(this.materials.values()),this.getEdgebands=()=>Array.from(this.edgebands.values()),this.getWeldments=()=>Array.from(this.weldments.values()),this.getLaminates=()=>Array.from(this.laminates.values()),this.getHardware=()=>Array.from(this.hardware.values()),this.getPrograms=()=>Array.from(this.programs.values()),this.getPanelProcesses=()=>Array.from(this.panelProcesses.values()),this.getMaterialsCost=()=>{let s=0;const t=this.getMaterials();for(const e of t)s+=e.cost;return s},this.getLaminatesCost=()=>{let s=0;const t=this.getLaminates();for(const e of t)s+=e.cost;return s},this.getEdgebandsCost=()=>{let s=0;const t=this.getEdgebands();for(const e of t)s+=e.cost;return s},this.getProgramsCost=()=>{let s=0;const t=this.getPrograms();for(const e of t)s+=e.cost;return s},this.getHardwareCost=()=>{let s=0;const t=this.getHardware();for(const e of t)s+=e.cost;return s},this.getPanelProcessesCost=()=>{let s=0;const t=this.getPanelProcesses();for(const e of t)s+=e.cost;return s},this.getWeldmentsCost=()=>{let s=0;const t=this.getWeldments();for(const e of t)s+=e.cost;return s},this.getTotal=()=>this.getMaterialsCost()+this.getEdgebandsCost()+this.getLaminatesCost()+this.getProgramsCost()+this.getHardwareCost()+this.getPanelProcessesCost()+this.getWeldmentsCost()}addMaterials(s){for(const t of s)t.type===1&&this.laminates.set(t.key,t),t.type===0&&this.materials.set(t.key,t)}addWeldmentMaterials(s){for(const t of s)this.weldments.set(t.key,t)}addEdgebands(s){for(const t of s)this.edgebands.set(t.key,t)}addHardware(s){for(const t of s)this.hardware.set(t.key,t)}addPrograms(s){for(const t of s)this.programs.set(t.key,t)}addPanelProcesses(s){for(const t of s)this.panelProcesses.set(t.key,t)}}class jt{constructor(s,t,e,a,i,o,n,r){this.materials=s,this.laminates=t,this.edgebands=e,this.weldments=a,this.programs=i,this.hardware=o,this.panelProcesses=n,this.cost=r}static createFromData(s,t,e,a,i,o){const n=new ka;return n.addMaterials(s),n.addWeldmentMaterials(t),n.addEdgebands(e),n.addPrograms(a),n.addHardware(i),n.addPanelProcesses(o),new jt(n.getMaterials(),n.getLaminates(),n.getEdgebands(),n.getWeldments(),n.getPrograms(),n.getHardware(),n.getPanelProcesses(),{materials:n.getMaterialsCost(),edgebands:n.getEdgebandsCost(),laminates:n.getLaminatesCost(),programs:n.getProgramsCost(),hardware:n.getHardwareCost(),panelProcesses:n.getPanelProcessesCost(),weldments:n.getWeldmentsCost(),total:n.getTotal()})}}class He extends y{addInstances(s){for(const t of s)this.addInstance(t.key,as.fromToolBusiness(t));return this}}class je{constructor(){this.instances=new Map,this.addInstance=(s,t)=>{const e=this.instances.get(s);e?e.push(t):this.instances.set(s,[t])},this.addInstances=(s,t,e)=>{for(const a of s.typedObjects){const i=t.get(a);if(i){const n=i.variables.TOTYPES.split(";");for(const r of n)this.addInstance(r,i)}const o=e.get(a);if(o){const n=o.variables.TOTYPES.split(";");for(const r of n)this.addInstance(r,o)}}return this},this.getInstancesByName=s=>this.instances.get(s)||void 0,this.getAll=()=>Object.fromEntries(this.instances)}}class Ge extends y{addInstances(s){for(const t of s){const e=t.getCutlist(),a=this.instances.get(e);if(a)a.addChildren(Z.fromWeldmentBusinessChild(t));else{const i=Z.fromWeldmentBusiness(t);i.addChildren(Z.fromWeldmentBusinessChild(t)),this.addInstance(e,i)}}return this}get(s){var e;const t=this.instances.get(s);if(t)return t;for(const a of this.instances.values())for(const i of(e=a.children)!=null?e:[])if(i.key===s)return i}getFromRefPart(s){const t=[],e=Array.from(this.instances.values());for(const a of e)a.refPart===s&&t.push(a);return t}}class $e extends y{addInstances(s){for(const t of s)this.addInstance(t.key,Xe.fromMaterialBusiness(t));return this}}const q=class q{constructor(s,t,e,a,i,o,n,r,g,d,h,c,m,f,u,p,b,P,w,T,v,I,A,S,E,k,N,L,x,F,U,Ls,Os,Ws,Vs,xs,Fs,Us,Hs,js,Gs,$s,Zs,Qs,qs,zs,Je,_e,sa,ta,ea,aa,ia){this.database=s,this.settings=t,this.project=e,this.panels=a,this.stocks=i,this.parts=o,this.assemblies=n,this.edgebands=r,this.edgebandMaterials=g,this.laminates=d,this.materials=h,this.weldmentMaterials=c,this.programs=m,this.sheets=f,this.programParts=u,this.tools=p,this.spindles=b,this.costs=P,this.messages=w,this.typedObjects=T,this.frames=v,this.hardware=I,this.excludedItems=A,this.panelProcesses=S,this.processZones=E,this.weldments=k,this.labelsPanels=N,this.labelsFrames=L,this.summary=x,this.panelManager=F,this.stockManager=U,this.partManager=Ls,this.assemblyManager=Os,this.edgebandManager=Ws,this.edgebandMaterialManager=Vs,this.laminateManager=xs,this.materialManager=Fs,this.weldmentMaterialManager=Us,this.programManager=Hs,this.sheetManager=js,this.programPartManager=Gs,this.toolManager=$s,this.spindleManager=Zs,this.costManager=Qs,this.messageManager=qs,this.typedObjectManager=zs,this.frameManager=Je,this.hardwareManager=_e,this.cuttingPatternManager=sa,this.panelProcessManager=ta,this.processZoneManager=ea,this.weldmentManager=aa,this.labelManager=ia,this.relateData=()=>(this.assignDataToEdgebands(),this.assignDataToStocks(),this.assignDataToWeldments(),this.assignDataToLaminates(),this.assignDataToPanels(),this.assignDataToAssemblies(),this.assignSubAssemblies(),this.assignDataToFrames(),this.assignDataToParts(),this.assignDataToSheets(),this.assignDataToPrograms(),this.assignDataToProgramParts(),this.assignDataToProcessZones(),this)}static createFromRawData(s,t){const e=rs.createFromRawData(s,t),a=qe.fromProjectBusiness(e.projectBusiness),i=new Re().addInstances(e.panelsBusiness),o=new Ue().addInstances(e.stocksBusiness),n=new Le().addInstances(e.partsBusiness),r=new De().addInstances(e.assembliesBusiness),g=new Ie().addInstances(e.edgebandsBusiness),d=new ve().addInstances(e.edgebandMaterialsBusiness),h=new Be().addInstances(e.laminatesBusiness),c=new Se().addInstances(e.materialsBusiness),m=new $e().addInstances(e.weldmentMaterialsBusiness),f=new We().addInstances(e.programsBusiness),u=new xe().addInstances(e.sheetBusiness),p=new Ve().addInstances(e.programPartsBusiness),b=new He().addInstances(e.toolsBusiness),P=new Fe().addInstances(e.spindlesBusiness),w=new Te().addInstances(e.costsBusiness),T=new Ee,v=new je().addInstances(s,n,r),I=new Ce().addInstances(e.framesBusiness),A=new Ae().addInstances(e.hardwaresBusiness),S=new Ta().addInstances(e.excludedItemsBusiness),E=new ke().createFromData(s,i.getAll()),k=new Ne().addInstances(e.panelProcessesBusiness),N=new Oe().addInstances(e.processZonesBusiness),L=new Ge().addInstances(e.weldmentsBusiness),x=j.makeLabels(i.getAll(),!0),F=j.makeLabels(I.getAll()),U=jt.createFromData(c.getAll(),m.getAll(),d.getAll(),f.getAll(),A.getAll(),k.getAll());return T.processMessages(a,i.getAll(),o.getAll(),n.getAll(),r.getAll(),g.getAll(),h.getAll(),c.getAll(),f.getAll(),u.getAll(),p.getAll(),b.getAll(),P.getAll()),new q(s,t,a,i.getAll(),o.getAll(),n.getAll(),r.getAll(),g.getAll(),d.getAll(),h.getAll(),c.getAll(),m.getAll(),f.getAll(),u.getAll(),p.getAll(),b.getAll(),P.getAll(),w.getAll(),T.getAll(),v.getAll(),I.getAll(),A.getAll(),S.getAll(),k.getAll(),N.getAll(),L.getAll(),x,F,U,i,o,n,r,g,d,h,c,m,f,u,p,b,P,w,T,v,I,A,E,k,N,L,j).relateData()}assignDataToEdgebands(){for(const s of this.edgebandManager.getAll())s.material=this.edgebandMaterialManager.get(s.refMaterial),s.part=this.partManager.get(s.refPanel),s.panel=this.panelManager.get(s.refPanel)}assignDataToStocks(){for(const s of this.stocks)s.material=this.materialManager.get(s.refMaterial),s.part=this.partManager.get(s.refPart),s.panel=this.panelManager.get(s.refPart)}assignDataToWeldments(){for(const s of this.weldments)s.material=this.materialManager.get(s.refMaterial),s.part=this.partManager.get(s.refPart)}assignDataToLaminates(){for(const s of this.laminateManager.getAll())s.material=this.materialManager.get(s.refMaterial),s.part=this.partManager.get(s.refPart),s.panel=this.panelManager.get(s.refPart)}assignDataToPanels(){var s;for(const t of this.panelManager.getAll()){this.assignDataToPanel(t);for(const e of(s=t.children)!=null?s:[])this.assignDataToPanel(e)}}assignDataToPanel(s){var e;s.project=this.project;const t=this.partManager.get(s.key);t&&(s.part=t);for(const a of s.refStocks){const i=this.stockManager.get(a);i&&(s.stocks.push(i),i.material||console.log("material not found for stock",i.key,"in panel",s.key),i.variables.ST_N==="CORE"?s.material=i.material:((e=i.material)==null?void 0:e.type)===0&&s.layers.push(i));const o=this.laminateManager.get(a);o&&(s.laminates.push(o),o.name==="TOP"&&(s.laminateTop=o),o.name==="BOTTOM"&&(s.laminateBottom=o))}for(const a of s.refEdgeband){const i=this.edgebandManager.get(a);i&&(s.edgebands.push(i),i.position==="F"&&(s.edgebandFront=i),i.position==="B"&&(s.edgebandBack=i),i.position==="L"&&(s.edgebandLeft=i),i.position==="R"&&(s.edgebandRight=i))}for(const a of s.refPrograms){const i=this.programManager.get(a);i&&(s.programs.push(i),i.panel=s,i.material=s.material,t&&(i.part=t))}for(const a of s.refProcessZones){const i=this.processZoneManager.get(a);i&&s.processZones.push(i)}}assignDataToAssemblies(){for(const s of this.assemblyManager.getAll()){for(const t of s.refParts){const e=this.partManager.get(t);e&&s.parts.push(e)}for(const t of s.refPrograms){const e=this.programManager.get(t);e&&s.programs.push(e)}}}assignSubAssemblies(){for(const s of this.assemblyManager.getAll())for(const t of s.refAssemblies){const e=this.assemblyManager.get(t);e&&s.assemblies.push(e)}}assignDataToFrames(){var s,t;for(const e of this.frameManager.getAll()){for(const a of e.refParts){const i=this.partManager.get(a);if(i){(s=e.parts)==null||s.push(i);const r=this.weldmentManager.getFromRefPart(a);r&&(e.weldments=[...r])}const o=this.panelManager.get(a);if(o){(t=e.panels)==null||t.push(o);for(const r of o.programs)e.programs.push(r)}else console.warn("Panel not found for refPart: ".concat(a," in frame: ").concat(e.name));const n=this.hardwareManager.get(a);n&&e.hardware.push(n)}for(const a of e.refAssemblies){const i=this.assemblyManager.get(a);i&&e.assemblies.push(i);const o=this.hardwareManager.get(a);o&&e.hardware.push(o)}}}assignDataToParts(){var s;for(const t of this.partManager.getAll()){t.panel=t.refPanel?this.panelManager.get(t.refPanel):void 0;for(const e of(s=t.refStocks)!=null?s:[]){const a=this.stockManager.get(e);a&&t.stocks.push(a)}for(const e of t.refPrograms){const a=this.programManager.get(e);a&&t.programs.push(a)}}}assignDataToSheets(){var s,t;for(const e of this.sheets){for(const a of(s=e.refProgramParts)!=null?s:[]){const i=this.programPartManager.get(a);i&&e.programParts.push(i)}for(const a of(t=e.refTools)!=null?t:[]){const i=this.toolManager.get(a);i&&e.tools.push(i)}}}assignDataToPrograms(){var s;for(const t of this.programs)for(const e of(s=t.refTools)!=null?s:[]){const a=this.toolManager.get(e);a&&t.tools.push(a)}}assignDataToProgramParts(){for(const s of this.programParts){const t=this.panelManager.get(s.refPart);s.panel=t}}assignDataToProcessZones(){for(const s of this.processZones){const t=this.panelProcessManager.get(s.refPanelProcess);s.panelProcess=t}}};q.createNullInstance=()=>{const s=[];return new q({},{},{},s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,{},s,s,s,s,s,s,s,s,{},new Re,new Ue,new Le,new De,new Ie,new ve,new Be,new Se,new $e,new We,new xe,new Ve,new He,new Fe,new Te,new Ee,new je,new Ce,new Ae,new ke,new Ne,new Oe,new Ge,j)};let Ze=q;export{Ze as default};

import{d as W,j as e,r as f,e as $,B as y,F as R,T as c,f as E,g as F}from"./main-CbjDkmQq.js";import{B as M,I as G,Q as V}from"./BarcodeElement-D47eGF5q.js";import{E as D,P as O,S as Q}from"./SearchInput-B2UwrhoE.js";import{g as Y}from"./dataHelper-DZckQQkV.js";const q=W(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),J=W(e.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack"),K=W(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),U=({text:n,cellProperties:i,maxFontSize:t})=>{const s=f.useRef(null),[p,h]=f.useState(i.fontSize||t);return f.useEffect(()=>{const m=()=>{if(s.current){let l=p;for(s.current.style.fontSize="".concat(l,"px");(s.current.scrollWidth>s.current.clientWidth||s.current.scrollHeight>s.current.clientHeight)&&l>1;)l-=.5,s.current.style.fontSize="".concat(l,"px");h(l)}};i.wrapText||m()},[n,i.wrapText,p]),typeof n=="object"?e.jsx(e.Fragment,{}):e.jsx("div",{ref:s,style:{overflow:"hidden",textAlign:"center",fontSize:"".concat(p,"px"),whiteSpace:i.wrapText?"normal":"nowrap",display:"flex",alignItems:"flex-end",justifyContent:"left-end"},children:n})},X=({data:n,settings:i,format:t,isSelected:s,onSelect:p})=>{const{columns:h,rows:m,pageHeight:l,pageWidth:b,pagePaddingTop:x,pagePaddingBottom:g,pagePaddingLeft:o,pagePaddingRight:j,pageGapVertical:B,pageGapHorizontal:C,labelPadding:u,fontSize:w}=t,_=(l-(m-1)*C-x-g)/m,S=(b-(h-1)*B-o-j)/h,L=i.reduce((a,d)=>d.grid.ye>a?d.grid.ye:a,0)-1,P=(_-2*u)/L,H=(S-2*u)/12,I=(a,d,z)=>{const v=(a.grid.ye-a.grid.ys)*P,r=(a.grid.xe-a.grid.xs)*H;switch(a.formatter){case"qrcode":return e.jsx(V,{contents:d,height:v,width:r});case"image":return d||(d=z),e.jsx(G,{value:d,data:n});case"barcode":return e.jsx(M,{value:d});case"programIndicator":return e.jsx(O,{value:d});default:return e.jsx(U,{text:d,cellProperties:a,maxFontSize:w})}};return e.jsxs("div",{className:"label ".concat(s?"selected":""),style:{padding:"".concat(u,"mm"),position:"relative",cursor:"pointer",backgroundColor:s?"green":""},onClick:p,children:[s&&e.jsx("div",{className:"no-print",style:{position:"absolute",top:"5px",right:"5px",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(K,{color:"success"})}),i.map((a,d)=>{const{xs:z,xe:v,ys:r,ye:A}=a.grid,T=a.verAlign==="top"?"flex-start":a.verAlign==="bottom"?"flex-end":"center";let N="";return new RegExp(/«(.*?)»/g).test(a.field)?N=D(n,a.field):N=Y(n,a.field),e.jsx("div",{className:"label-cell",style:{gridColumn:"".concat(z," / ").concat(v),gridRow:"".concat(r," / ").concat(A),height:"".concat((A-r)*P,"mm"),display:"flex",alignItems:T,justifyContent:a.hozAlign||"center"},children:I(a,N,a.field)},d)})]})},Z=()=>e.jsx("div",{className:"label label-empty"}),ee=({data:n,settings:i,format:t})=>{const[s,p]=f.useState([]),h=g=>{p(o=>o.includes(g)?o.filter(j=>j!==g):[...o,g])},m="repeat(".concat(t.columns,", 1fr)"),l="repeat(".concat(t.rows,", 1fr)"),x=t.rows*t.columns-n.length;return e.jsxs("div",{className:"label-page",style:{height:t.pageHeight+"mm",width:t.pageWidth+"mm",gridTemplateColumns:m,gridTemplateRows:l,paddingTop:t.pagePaddingTop+"mm",paddingBottom:t.pagePaddingBottom+"mm",paddingLeft:t.pagePaddingLeft+"mm",paddingRight:t.pagePaddingRight+"mm",columnGap:t.pageGapVertical+"mm",rowGap:t.pageGapHorizontal+"mm"},children:[n.map((g,o)=>e.jsx(X,{data:g,settings:i,format:t,isSelected:s.includes(o),onSelect:()=>h(o)},o)),Array.from({length:x},(g,o)=>e.jsx(Z,{},"empty-".concat(o)))]})},k=n=>Number.isInteger(n)?n.toString():n.toFixed(2),te=({data:n,settings:i,format:t})=>{const[s,p]=f.useState(!0),{isDarkMode:h}=$(),m=()=>{p(!s)},{columns:l,rows:b,pageHeight:x,pageWidth:g,pagePaddingTop:o,pagePaddingBottom:j,pagePaddingLeft:B,pagePaddingRight:C,pageGapVertical:u,pageGapHorizontal:w,labelPadding:_}=t,S=n.length,L=b*l,P=Math.ceil(S/L),H=(x-(b-1)*w-o-j)/b,I=(g-(l-1)*u-B-C)/l,a=i.reduce((A,T)=>T.grid.ye>A?T.grid.ye:A,0)-1,d=(H-2*_)/a,z=(I-2*_)/12,v=L*P-S,r={paddingBottom:0,margin:0};return e.jsxs(y,{className:"no-print",style:{position:"relative",width:"100%",zIndex:10},children:[e.jsx(R,{color:"primary",size:"small","aria-label":"add",style:{position:"fixed",top:10,right:10},onClick:m,children:e.jsx(q,{style:{transition:"transform 0.3s",transform:s?"rotate(45deg)":"rotate(0deg)"}})}),e.jsxs(y,{sx:{position:"fixed",top:60,right:10,padding:"15px",backgroundColor:h?"black":"white",borderRadius:4,borderColor:h?"black":"gray",borderStyle:"solid",borderWidth:"1px",transition:"opacity 0.3s, transform 0.3s",opacity:s?1:0,transform:s?"translateY(0)":"translateY(-20px)",pointerEvents:s?"auto":"none"},children:[e.jsx(c,{variant:"h6",style:{marginBottom:"10px"},children:"Labels Statistics"}),e.jsxs(y,{style:{marginBottom:"15px"},children:[e.jsx(c,{style:{color:"#007ACC",fontWeight:"bold"},children:"General Information"}),e.jsxs(c,{style:r,children:["Total labels: ",S]}),e.jsxs(c,{style:r,children:["Labels per page: ",L]}),e.jsxs(c,{style:r,children:["Number of pages: ",P]}),e.jsxs(c,{style:r,children:["Empty labels: ",v]})]}),e.jsxs(y,{style:{marginBottom:"15px"},children:[e.jsx(c,{style:{color:"#007ACC",fontWeight:"bold"},children:"Page Layout"}),e.jsxs(c,{style:r,children:["Layout: ",b," x ",l]}),e.jsxs(c,{style:r,children:["Page height: ",x,"mm"]}),e.jsxs(c,{style:r,children:["Page width: ",g,"mm"]})]}),e.jsxs(y,{style:{marginBottom:"15px"},children:[e.jsx(c,{style:{color:"#007ACC",fontWeight:"bold"},children:"Label Dimensions"}),e.jsxs(c,{style:r,children:["Label height: ",k(H),"mm"]}),e.jsxs(c,{style:r,children:["Label width: ",k(I),"mm"]}),e.jsxs(c,{style:r,children:["Minimum cell height: ",k(d),"mm"]}),e.jsxs(c,{style:r,children:["Minimum cell width: ",k(z),"mm"]})]})]})]})},se=(n,i)=>n.filter(t=>Object.values(t).some(s=>String(s).toLowerCase().includes(String(i).toLowerCase()))),re=({data:n,settings:i,format:t})=>{const[s,p]=f.useState(""),h=E(),m=f.useCallback(F(p,300),[]);if(!i)return e.jsx("h1",{children:"Settings not provided"});const l=se(n,s),b=l.length,x=t.rows*t.columns,g=Math.ceil(b/x),o=Array.from({length:g},(B,C)=>{const u=C*x,w=u+x,_=l.slice(u,w);return e.jsxs(y,{children:[e.jsx(ee,{data:_,settings:i,format:t}),e.jsx("br",{})]},C)}),j=()=>{h(-1)};return e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"no-print",color:"primary",size:"small","aria-label":"add",style:{position:"fixed",top:10,left:10},onClick:j,children:e.jsx(J,{style:{transition:"transform 0.3s"}})}),e.jsx(y,{className:"no-print",sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",margin:"20px 0"},children:e.jsx(Q,{setFilter:m})}),e.jsx(te,{data:l,settings:i,format:t}),e.jsx(y,{className:"label-page-container",children:o})]})};export{re as L};

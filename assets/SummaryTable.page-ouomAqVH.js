import{j as e,P as k,B as d,T as u,u as C,a as P,c as S}from"./main-C2vc3o58.js";import{G as i,T as l,a as x,u as m,w as _}from"./Table-D878PMKE.js";import"./BarcodeElement-Dxq3lecf.js";import"./SearchInput-BsV9SoqE.js";import"./PDFElement-ye5JkFQf.js";const E=({value:n})=>e.jsx(k,{variant:"outlined",sx:{px:2,backgroundColor:"rgba(0, 0, 0, 0.1)",height:40,pageBreakInside:"avoid",my:1},children:e.jsxs(i,{container:!0,alignItems:"center",sx:{height:"100%"},children:[e.jsx(i,{item:!0,xs:4,children:e.jsx(d,{className:"no-print",sx:{height:"100%",display:"flex",alignItems:"center"}})}),e.jsx(i,{item:!0,xs:4,children:e.jsx(d,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(u,{variant:"h6",sx:{fontWeight:"bold",m:0},children:"Total"})})}),e.jsx(i,{item:!0,xs:4,children:e.jsx(d,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},children:e.jsxs("b",{children:["Â£",n.toFixed(2)]})})})]})}),R=()=>{const n=C(),c=P(),t=n==null?void 0:n.summary;if(!t)return e.jsx("div",{children:"No data available"});if(!c)return e.jsx("div",{children:"Settings not available"});const a=c.pages.summary,j=()=>{const p=[x.findTable("#Edgebands")[0],x.findTable("#Programs")[0]];let r=[];p.forEach((b,w)=>{const y="Table".concat(w+1),T=b.getColumns().filter(s=>s.isVisible()).map(s=>s.getField()).filter(s=>s),v=b.getData().map(s=>{const o={};return T.forEach(g=>{o[g]=s[g]}),o.source=y,o});r=r.concat(v)});const f=m.json_to_sheet(r),h=m.book_new();m.book_append_sheet(h,f,"CombinedTables"),_(h,"combined_visible_data.xlsx")};return e.jsxs(e.Fragment,{children:[e.jsx(u,{variant:"h1",children:"Summary"}),e.jsx(S,{onClick:j,children:"Download Excel"}),t.materials.length>0&&e.jsx(l,{header:a.tables.materials.title,data:t.materials,settings:a.tables.materials.table}),t.laminates.length>0&&e.jsx(l,{header:a.tables.laminates.title,data:t.laminates,settings:a.tables.laminates.table}),t.edgebands.length>0&&e.jsx(l,{header:a.tables.edgebands.title,data:t.edgebands,settings:a.tables.edgebands.table}),t.weldments.length>0&&e.jsx(l,{header:a.tables.weldments.title,data:t.weldments,settings:a.tables.weldments.table}),t.programs.length>0&&e.jsx(l,{header:a.tables.machining.title,data:t.programs,settings:a.tables.machining.table}),t.hardware.length>0&&e.jsx(l,{header:a.tables.hardware.title,data:t.hardware,settings:a.tables.hardware.table}),t.panelProcesses.length>0&&e.jsx(l,{header:a.tables.panelProcesses.title,data:t.panelProcesses,settings:a.tables.panelProcesses.table}),e.jsx(E,{value:t.cost.total})]})};export{R as default};
